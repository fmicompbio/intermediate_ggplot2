<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Charlotte Soneson, Michael Stadler">
<meta name="dcterms.date" content="2025-11-24">

<title>Intermediate ggplot2 - tips and tricks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="intermediate_ggplot2_files/libs/clipboard/clipboard.min.js"></script>
<script src="intermediate_ggplot2_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="intermediate_ggplot2_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="intermediate_ggplot2_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="intermediate_ggplot2_files/libs/quarto-html/popper.min.js"></script>
<script src="intermediate_ggplot2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="intermediate_ggplot2_files/libs/quarto-html/anchor.min.js"></script>
<link href="intermediate_ggplot2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="intermediate_ggplot2_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="intermediate_ggplot2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="intermediate_ggplot2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="intermediate_ggplot2_files/libs/bootstrap/bootstrap-55aa396ea3e988129bcec43acf404917.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="intermediate_ggplot2_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="intermediate_ggplot2_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="intermediate_ggplot2_files/libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="intermediate_ggplot2_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="intermediate_ggplot2_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="intermediate_ggplot2_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="intermediate_ggplot2_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="intermediate_ggplot2_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="intermediate_ggplot2_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#a-quick-look-at-the-data" id="toc-a-quick-look-at-the-data" class="nav-link" data-scroll-target="#a-quick-look-at-the-data">A quick look at the data</a></li>
  <li><a href="#defining-a-general-theme" id="toc-defining-a-general-theme" class="nav-link" data-scroll-target="#defining-a-general-theme">Defining a general theme</a></li>
  <li><a href="#changing-order-of-factor-levels-with-the-forcats-package" id="toc-changing-order-of-factor-levels-with-the-forcats-package" class="nav-link" data-scroll-target="#changing-order-of-factor-levels-with-the-forcats-package">Changing order of factor levels with the <code>forcats</code> package</a>
  <ul class="collapse">
  <li><a href="#order-by-frequency" id="toc-order-by-frequency" class="nav-link" data-scroll-target="#order-by-frequency">Order by frequency</a></li>
  <li><a href="#order-by-their-first-appearance-in-the-data" id="toc-order-by-their-first-appearance-in-the-data" class="nav-link" data-scroll-target="#order-by-their-first-appearance-in-the-data">Order by their first appearance in the data</a></li>
  <li><a href="#lump-together-rare-factor-levels" id="toc-lump-together-rare-factor-levels" class="nav-link" data-scroll-target="#lump-together-rare-factor-levels">Lump together rare factor levels</a></li>
  <li><a href="#reorder-one-factor-by-the-values-of-another-variable" id="toc-reorder-one-factor-by-the-values-of-another-variable" class="nav-link" data-scroll-target="#reorder-one-factor-by-the-values-of-another-variable">Reorder one factor by the values of another variable</a></li>
  </ul></li>
  <li><a href="#faceting" id="toc-faceting" class="nav-link" data-scroll-target="#faceting">Faceting</a>
  <ul class="collapse">
  <li><a href="#facet_wrap" id="toc-facet_wrap" class="nav-link" data-scroll-target="#facet_wrap"><code>facet_wrap</code></a></li>
  <li><a href="#facet_grid" id="toc-facet_grid" class="nav-link" data-scroll-target="#facet_grid"><code>facet_grid</code></a></li>
  <li><a href="#faceting-bar-plots-with-different-numbers-of-categories-in-each-facet" id="toc-faceting-bar-plots-with-different-numbers-of-categories-in-each-facet" class="nav-link" data-scroll-target="#faceting-bar-plots-with-different-numbers-of-categories-in-each-facet">Faceting bar plots with different numbers of categories in each facet</a></li>
  <li><a href="#showing-all-the-data-as-background-in-each-facet" id="toc-showing-all-the-data-as-background-in-each-facet" class="nav-link" data-scroll-target="#showing-all-the-data-as-background-in-each-facet">Showing all the data as ‘background’ in each facet</a></li>
  </ul></li>
  <li><a href="#adjusting-widths-of-bars-in-bar-plots" id="toc-adjusting-widths-of-bars-in-bar-plots" class="nav-link" data-scroll-target="#adjusting-widths-of-bars-in-bar-plots">Adjusting widths of bars in bar plots</a></li>
  <li><a href="#rastering-layers-to-limit-the-size-of-plots-with-many-elements" id="toc-rastering-layers-to-limit-the-size-of-plots-with-many-elements" class="nav-link" data-scroll-target="#rastering-layers-to-limit-the-size-of-plots-with-many-elements">Rastering layers to limit the size of plots with many elements</a>
  <ul class="collapse">
  <li><a href="#using-ggrastr" id="toc-using-ggrastr" class="nav-link" data-scroll-target="#using-ggrastr">Using <code>ggrastr</code></a></li>
  <li><a href="#using-scattermore" id="toc-using-scattermore" class="nav-link" data-scroll-target="#using-scattermore">Using <code>scattermore</code></a></li>
  </ul></li>
  <li><a href="#changing-scales-for-axes" id="toc-changing-scales-for-axes" class="nav-link" data-scroll-target="#changing-scales-for-axes">Changing scales for axes</a>
  <ul class="collapse">
  <li><a href="#axes-with-percent-values" id="toc-axes-with-percent-values" class="nav-link" data-scroll-target="#axes-with-percent-values">Axes with percent (%) values</a></li>
  <li><a href="#limit-axis-range" id="toc-limit-axis-range" class="nav-link" data-scroll-target="#limit-axis-range">Limit axis range</a></li>
  </ul></li>
  <li><a href="#interactive-plots" id="toc-interactive-plots" class="nav-link" data-scroll-target="#interactive-plots">Interactive plots</a>
  <ul class="collapse">
  <li><a href="#ggplotly" id="toc-ggplotly" class="nav-link" data-scroll-target="#ggplotly">(gg)plotly</a></li>
  <li><a href="#ggiraph" id="toc-ggiraph" class="nav-link" data-scroll-target="#ggiraph">ggiraph</a></li>
  </ul></li>
  <li><a href="#titles-subtitles-and-captions" id="toc-titles-subtitles-and-captions" class="nav-link" data-scroll-target="#titles-subtitles-and-captions">Titles, subtitles and captions</a></li>
  <li><a href="#adding-statistical-information-to-plots" id="toc-adding-statistical-information-to-plots" class="nav-link" data-scroll-target="#adding-statistical-information-to-plots">Adding statistical information to plots</a></li>
  <li><a href="#adding-text-and-annotation" id="toc-adding-text-and-annotation" class="nav-link" data-scroll-target="#adding-text-and-annotation">Adding text and annotation</a></li>
  <li><a href="#customizing-legends" id="toc-customizing-legends" class="nav-link" data-scroll-target="#customizing-legends">Customizing legends</a>
  <ul class="collapse">
  <li><a href="#suppressing-the-legend" id="toc-suppressing-the-legend" class="nav-link" data-scroll-target="#suppressing-the-legend">Suppressing the legend</a></li>
  <li><a href="#legend-position" id="toc-legend-position" class="nav-link" data-scroll-target="#legend-position">Legend position</a></li>
  <li><a href="#customizing-legend-formatting" id="toc-customizing-legend-formatting" class="nav-link" data-scroll-target="#customizing-legend-formatting">Customizing legend formatting</a></li>
  </ul></li>
  <li><a href="#specifying-colors" id="toc-specifying-colors" class="nav-link" data-scroll-target="#specifying-colors">Specifying colors</a>
  <ul class="collapse">
  <li><a href="#specifying-color-gradients-using-defined-colors" id="toc-specifying-color-gradients-using-defined-colors" class="nav-link" data-scroll-target="#specifying-color-gradients-using-defined-colors">Specifying color gradients using defined colors</a></li>
  <li><a href="#named-color-palettes" id="toc-named-color-palettes" class="nav-link" data-scroll-target="#named-color-palettes">Named color palettes</a></li>
  <li><a href="#using-multiple-color-scales-for-different-layers" id="toc-using-multiple-color-scales-for-different-layers" class="nav-link" data-scroll-target="#using-multiple-color-scales-for-different-layers">Using multiple color scales for different layers</a></li>
  <li><a href="#cap-color-range" id="toc-cap-color-range" class="nav-link" data-scroll-target="#cap-color-range">Cap color range</a></li>
  <li><a href="#creating-darkerlighter-variants-of-a-color" id="toc-creating-darkerlighter-variants-of-a-color" class="nav-link" data-scroll-target="#creating-darkerlighter-variants-of-a-color">Creating darker/lighter variants of a color</a></li>
  </ul></li>
  <li><a href="#using-after_stat-previously-...." id="toc-using-after_stat-previously-...." class="nav-link" data-scroll-target="#using-after_stat-previously-....">Using <code>after_stat</code> (previously <code>..*..</code>)</a></li>
  <li><a href="#combining-plot-panels" id="toc-combining-plot-panels" class="nav-link" data-scroll-target="#combining-plot-panels">Combining plot panels</a>
  <ul class="collapse">
  <li><a href="#cowplot" id="toc-cowplot" class="nav-link" data-scroll-target="#cowplot">cowplot</a></li>
  <li><a href="#patchwork" id="toc-patchwork" class="nav-link" data-scroll-target="#patchwork">patchwork</a></li>
  </ul></li>
  <li><a href="#other-material-sources-for-some-of-the-material-presented-above" id="toc-other-material-sources-for-some-of-the-material-presented-above" class="nav-link" data-scroll-target="#other-material-sources-for-some-of-the-material-presented-above">Other material, sources for some of the material presented above</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Intermediate ggplot2 - tips and tricks</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Charlotte Soneson, Michael Stadler </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>In this document, we have made an attempt to collect useful “tips and tricks” related to the use of <code>ggplot2</code> and associated packages. It does not aim to provide a general introduction to <code>ggplot2</code> - for that, see e.g.&nbsp;the following resources:</p>
<ul>
<li>The <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code> website</a> and <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf">cheat sheet</a></li>
<li>The <a href="https://ggplot2-book.org/"><code>ggplot2</code> book</a></li>
<li>A <a href="http://exts.ggplot2.tidyverse.org/">list of <code>ggplot2</code> extensions</a></li>
</ul>
<p>The different sections below are mostly independent from each other, and cover different aspects of adjusting <code>ggplot</code> objects.</p>
<section id="load-packages" class="level1">
<h1>Load packages</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if problematic packages are available</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ggforce_available <span class="ot">&lt;-</span> <span class="fu">require</span>(ggforce, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ggrastr_available <span class="ot">&lt;-</span> <span class="fu">require</span>(ggrastr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>ggiraph_available <span class="ot">&lt;-</span> <span class="fu">require</span>(ggiraph, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## data manipulation</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(scales)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(forcats)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(dplyr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(tidyr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">## ggplot2 + extension packages</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ggforce_available) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">library</span>(ggforce)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggalt)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggridges)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(GGally)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggsignif)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggstatsplot)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(gghighlight)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggrepel)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggtext)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggnewscale)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ggrastr_available) {</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">library</span>(ggrastr)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(scattermore)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(directlabels)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="do">## packages to combine multiple figures</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(patchwork)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(cowplot)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="do">## packages for interactive graphics</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(plotly)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ggiraph_available) {</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">library</span>(ggiraph)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="do">## color packages</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(circlize)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(colorspace)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="do">## other packages</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(sessioninfo)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(fueleconomy)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="a-quick-look-at-the-data" class="level1">
<h1>A quick look at the data</h1>
<p>We will use three different data sets to illustrate the tips and tricks in this document. The first one comes from the <code>fueleconomy</code> package, and provides fuel economy data from the EPA between the years 1985 and 2015. We subset the data to only the vehicles from the year 2000 or later.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(vehicles <span class="ot">&lt;-</span> vehicles <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2000</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16,649 × 12
      id make  model  year class       trans drive   cyl displ fuel    hwy   cty
   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 16573 Acura 3.2CL  2001 Compact Ca… Auto… Fron…     6   3.2 Prem…    27    17
 2 17489 Acura 3.2CL  2002 Compact Ca… Auto… Fron…     6   3.2 Prem…    27    17
 3 18458 Acura 3.2CL  2003 Compact Ca… Manu… Fron…     6   3.2 Prem…    26    17
 4 18459 Acura 3.2CL  2003 Compact Ca… Auto… Fron…     6   3.2 Prem…    27    17
 5 15871 Acura 3.2TL  2000 Midsize Ca… Auto… Fron…     6   3.2 Prem…    27    17
 6 16734 Acura 3.2TL  2001 Midsize Ca… Auto… Fron…     6   3.2 Prem…    27    17
 7 17664 Acura 3.2TL  2002 Midsize Ca… Auto… Fron…     6   3.2 Prem…    27    17
 8 18629 Acura 3.2TL  2003 Midsize Ca… Auto… Fron…     6   3.2 Prem…    27    17
 9 15872 Acura 3.5RL  2000 Midsize Ca… Auto… Fron…     6   3.5 Prem…    22    16
10 16735 Acura 3.5RL  2001 Midsize Ca… Auto… Fron…     6   3.5 Prem…    22    16
# ℹ 16,639 more rows</code></pre>
</div>
</div>
<p>The second data set is provided with the <code>ggplot2</code> package, and contains data on a set of diamonds.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>diamonds</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53,940 × 10
   carat cut       color clarity depth table price     x     y     z
   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31
 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75
 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39
# ℹ 53,930 more rows</code></pre>
</div>
</div>
<p>The third data set is the <code>iris</code> data set, which contains measurements of petal and sepal length and width for 150 iris flowers of different species.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
</section>
<section id="defining-a-general-theme" class="level1">
<h1>Defining a general theme</h1>
<p>Before we start making plots, we define a theme that we will apply to the plots that we generate, when applicable. There are many ways of doing this - arguably the most straightforward is to assign the theme-related parts of a <code>ggplot</code> call to a variable, and add this variable to all subsequent plots.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define theme variable</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ggp <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Use in any ggplot (take care to put it in the right position in the call</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="do">## if the plot itself defines theme aspects)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> fuel)) <span class="sc">+</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is also possible to set the default theme that is used for all plots in the session. For example, to make <code>theme_bw()</code> the default theme, we could do:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>old <span class="ot">&lt;-</span> <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>ggplot2</code> also contains functions for replacing specific elements of a theme, see <a href="https://ggplot2.tidyverse.org/reference/theme_get.html">here</a> for an overview.</p>
</section>
<section id="changing-order-of-factor-levels-with-the-forcats-package" class="level1">
<h1>Changing order of factor levels with the <code>forcats</code> package</h1>
<p>In this section, we will illustrate how to use the <code>forcats</code> package to reorder the levels of a factor “on the fly”. Arguably, this is not strictly (gg)plot related, and it can be applied to any factor; however, it is often useful to be able to reorder factor levels to obtain the most informative graphical representation of a data set.</p>
<p>We start with a basic bar plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> fuel)) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="order-by-frequency" class="level2">
<h2 class="anchored" data-anchor-id="order-by-frequency">Order by frequency</h2>
<p>The <code>fct_infreq</code> function will order the factor levels by their frequency.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_infreq</span>(fuel))) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="order-by-their-first-appearance-in-the-data" class="level2">
<h2 class="anchored" data-anchor-id="order-by-their-first-appearance-in-the-data">Order by their first appearance in the data</h2>
<p>The <code>fct_inorder</code> function will order the factor levels by the order they appear in the data set.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_inorder</span>(fuel))) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lump-together-rare-factor-levels" class="level2">
<h2 class="anchored" data-anchor-id="lump-together-rare-factor-levels">Lump together rare factor levels</h2>
<p>Sometimes we have a large number of factor levels, many of which are very rare. The <a href="https://forcats.tidyverse.org/reference/fct_lump.html"><code>fct_lump_*</code></a> set of functions can be used to group together rare levels into an “Other” category. Here we illustrate the use of the <code>fct_lump_n</code> function, which lumps together all levels except for the <code>n</code> most frequent ones.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_infreq</span>(<span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">other_level =</span> <span class="st">"Other"</span>)))) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="reorder-one-factor-by-the-values-of-another-variable" class="level2">
<h2 class="anchored" data-anchor-id="reorder-one-factor-by-the-values-of-another-variable">Reorder one factor by the values of another variable</h2>
<p>The <code>fct_reorder</code> function can be used to reorder the levels of a factor by the value of another variable.</p>
<!-- For example, to plot library sizes of samples, ordered by experiment.-->
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">median_hwy =</span> <span class="fu">median</span>(hwy)), </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(class, median_hwy), <span class="at">y =</span> median_hwy)) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">median_hwy =</span> <span class="fu">median</span>(hwy)), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(class, median_hwy), <span class="at">y =</span> median_hwy)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Without prior aggregation - show all points, but order levels by median hwy</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(class, hwy, <span class="at">.fun =</span> median), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="faceting" class="level1">
<h1>Faceting</h1>
<p>Faceting splits a plot into multiple panels according to the value of a given variable. There are several faceting function in <code>ggplot2</code>, and additional ones provided in extension packages to address missing functionality.</p>
<section id="facet_wrap" class="level2">
<h2 class="anchored" data-anchor-id="facet_wrap"><code>facet_wrap</code></h2>
<p>The <code>facet_wrap</code> function wraps a sequence of panels into a 2-dimensional layout. We can set the number of rows or columns to split the panels over.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Default</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>)) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set number of rows</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By default, the x- and y-axes are shared between the panels. The <code>scales</code> argument can be used to set either or both of them to be “free” (i.e., panel-specific). Setting <code>scales = "free"</code> decouples both the x- and y-axes, setting it to <code>"free_x"</code> or <code>"free_y"</code> decouples only one of the axes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="facet_grid" class="level2">
<h2 class="anchored" data-anchor-id="facet_grid"><code>facet_grid</code></h2>
<p>The <code>facet_grid</code> function places the set of panels in a matrix layout, where each dimension is determined by a given variable. It is typically most useful when we want to stratify by two discrete variables.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="fu">fct_lump_n</span>(class, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">~</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>)) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>We can set <code>scales = "free"</code> also here, but note that it will affect the entire rows/columns in the same way (i.e., panels are not completely decoupled).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="fu">fct_lump_n</span>(class, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">~</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="faceting-bar-plots-with-different-numbers-of-categories-in-each-facet" class="level2">
<h2 class="anchored" data-anchor-id="faceting-bar-plots-with-different-numbers-of-categories-in-each-facet">Faceting bar plots with different numbers of categories in each facet</h2>
<p>Faceting with bar plots may require extra attention, if not all facets contain the same set of categories.</p>
<p>Using <code>facet_wrap</code> with <code>scales = "fixed"</code> leaves a missing bar for empty categories.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"fixed"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Using <code>facet_wrap</code> with <code>scales = "free"</code> doesn’t leave empty space, but the bars are of different width.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The <code>facet_grid</code> function lets us adjust the space allocated to each facet, in order to keep the bar widths the same but not leave empty space for missing categories, but keeps the y-axis the same across the panels.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Finally, the <code>facet_row</code> function from the <code>ggforce</code> package lets us adjust the space allocated to each facet and at the same time use a free y-axis.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_row</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="showing-all-the-data-as-background-in-each-facet" class="level2">
<h2 class="anchored" data-anchor-id="showing-all-the-data-as-background-in-each-facet">Showing all the data as ‘background’ in each facet</h2>
<p>Sometimes we would like to show all the data as the “background” in each facet, while highlighting the points corresponding to the specific facet. This can be achieved in several ways. A neat trick is to add an additional layer using a modified data set where the faceting variable is removed:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">transform</span>(vehicles, <span class="at">fuel =</span> <span class="cn">NULL</span>), <span class="at">colour =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Another option is to use the <code>gghighlight</code> package. The package can be used to highlight points in a single panel:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel_lumped =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>)),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> fuel_lumped)) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gghighlight</span>(fuel_lumped <span class="sc">==</span> <span class="st">"Premium"</span>) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Tried to calculate with group_by(), but the calculation failed.
Falling back to ungrouped filter operation...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>label_key: fuel_lumped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Too many data points, skip labeling</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or to highlight all points, and additionally facet:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel_lumped =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>)),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> fuel_lumped)) <span class="sc">+</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gghighlight</span>() <span class="sc">+</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> fuel_lumped, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>label_key: fuel_lumped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Too many data points, skip labeling</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If the number of highlighted points is not too large, <code>gghighlight</code> will add a label for each point.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel_lumped =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>)),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gghighlight</span>(hwy <span class="sc">-</span> cty <span class="sc">&gt;</span> <span class="dv">15</span> <span class="sc">|</span> ((<span class="fu">abs</span>(hwy <span class="sc">-</span> <span class="dv">60</span>) <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">&amp;</span> (<span class="fu">abs</span>(cty <span class="sc">-</span> <span class="dv">75</span>) <span class="sc">&lt;</span> <span class="dv">10</span>)), </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_key =</span> make, <span class="at">max_highlight =</span> <span class="dv">25</span>) <span class="sc">+</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="adjusting-widths-of-bars-in-bar-plots" class="level1">
<h1>Adjusting widths of bars in bar plots</h1>
<p>We saw above how to adjust the widths of panels in faceted bar plots. Here, we will instead see how to adjust the widths of individual bars, when displayed side-by-side in a single panel.</p>
<p>The default layout of a bar plot where each bar is further split by a variable is to stack the components on top of each other:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>We can also get the bars side-by-side by setting the <code>position</code> argument (either <code>position = "dodge"</code> or <code>position = position_dodge()</code>). However, if there are different numbers of subcategories, the bars will have different widths.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>We can use the <code>position_dodge2()</code> function to preserve the widths of the bars. However, the categories will be centered for each value on the x-axis, which means that the same bar will not always appear in the same relative position.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge2</span>(<span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>In order to keep the widths of the bars and at the same time place them in consistent relative positions for each value on the x-axis, one way is to first summarize the data, making sure to represent the empty categories with a count of zero, and then using the code in the previous chunk to preserve the widths of the bars.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Side-by-side bar plot with consistent width and position</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">make =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">count</span>(fuel, make) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">complete</span>(<span class="at">fuel =</span> <span class="fu">unique</span>(fuel), <span class="at">make =</span> <span class="fu">unique</span>(make), </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)), </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> fuel, <span class="at">y =</span> n, <span class="at">fill =</span> make)) <span class="sc">+</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>(<span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rastering-layers-to-limit-the-size-of-plots-with-many-elements" class="level1">
<h1>Rastering layers to limit the size of plots with many elements</h1>
<p>A common issue for plots that contain many elements, such as a scatter plot with thousands of genes, is that the resulting plot file may get large and slow to display, especially when saved a vector-based graphics device like <code>pdf</code> or <code>svg</code>.</p>
<p>A possible solution to this problem is to render the plot into a bitmap image by saving it to a bitmap-based graphics device like <code>png</code> or <code>jpeg</code>. However, a disadvantage of this approach is that all elements will be rendered into that image and no adjustments to individual elements can be done afterwards, like for example increasing the text size of the axis titles.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>get_filesize_kb <span class="ot">&lt;-</span> <span class="cf">function</span>(plotobj, <span class="at">outformat =</span> <span class="fu">c</span>(<span class="st">"pdf"</span>, <span class="st">"png"</span>)) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># helper function that returns the size of a plot</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># when saved to a `outformat` file in kilo-bytes</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    outformat <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(outformat)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="fu">paste0</span>(<span class="st">"."</span>, outformat))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="at">filename =</span> tf, <span class="at">plot =</span> plotobj, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    filesize <span class="ot">&lt;-</span> <span class="fu">file.info</span>(tf)<span class="sc">$</span>size</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlink</span>(tf)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s-file of size %.1f kb</span><span class="sc">\n</span><span class="st">"</span>, outformat, filesize <span class="sc">/</span> <span class="dv">1000</span>))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">invisible</span>(filesize))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="do">## normal plot with many elements</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price)) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    ggp</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="fu">get_filesize_kb</span>(p0, <span class="st">"pdf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>pdf-file of size 1456.6 kb</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_filesize_kb</span>(p0, <span class="st">"png"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png-file of size 633.8 kb</code></pre>
</div>
</div>
<section id="using-ggrastr" class="level2">
<h2 class="anchored" data-anchor-id="using-ggrastr">Using <code>ggrastr</code></h2>
<p>A more elegant solution is provided by the <code>ggrastr</code> package, that allows to raster just the problematic layer, while keeping the remaining layers as vectors, for example using the <code>geom_point_rast</code> function:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggrastr::geom_*_rastr layers</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point_rast</span>(<span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">raster.dpi =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    ggp</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_filesize_kb</span>(p1, <span class="st">"pdf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>or by using <code>rasterise</code>, which can wrap any other layer or even whole plots, and automatically rasterize all layers of certain types (<code>layers</code> argument). The resolution of the raster images can be controlled with <code>dpi</code> (or <code>raster.dpi</code> above):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggrastr::rasterise() wrapper</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ... around the whole plot</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">rasterise</span>(p1, <span class="at">layers =</span> <span class="fu">c</span>(<span class="st">"Point"</span>, <span class="st">"Title"</span>)) <span class="co"># raster all layers of given types</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_filesize_kb</span>(p2, <span class="st">"pdf"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ... around a specific layer</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price)) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rasterise</span>(<span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.2</span>), <span class="at">dpi =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    ggp</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>p3</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">get_filesize_kb</span>(p3, <span class="st">"pdf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="using-scattermore" class="level2">
<h2 class="anchored" data-anchor-id="using-scattermore">Using <code>scattermore</code></h2>
<p>The <code>scattermore</code> uses a conceptually similar approach, but is optimized for very large numbers of points (think many millions). It provides two functions:</p>
<ul>
<li><code>geom_scattermore()</code> behaves fully as any other ggplot2 geometrical layer</li>
<li><code>geom_scattermost()</code> that plots even faster at the expense of bypassing most of the ggplot functionality (e.g.&nbsp;you need to provide a two-colom data frame directly to the function)</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price, <span class="at">color =</span> clarity)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_scattermore</span>(<span class="at">pointsize =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_scattermost ignores data and aesthetic mappings</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; need to provide data frame and if desired color vector</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_scattermost</span>(<span class="at">xy =</span> <span class="fu">as.data.frame</span>(diamonds[, <span class="fu">c</span>(<span class="st">'carat'</span>, <span class="st">'price'</span>)]),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">pointsize =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="changing-scales-for-axes" class="level1">
<h1>Changing scales for axes</h1>
<p>In this section, we illustrate how change the axis ranges or tick labels of our plots from the default values.</p>
<section id="axes-with-percent-values" class="level2">
<h2 class="anchored" data-anchor-id="axes-with-percent-values">Axes with percent (%) values</h2>
<p>In some cases the displayed values are fractions, that we would like to express instead as percentages. This can be achieved using the <code>scales</code> package:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## scales::percent will multiply the values by 100 and add a % sign</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## scales::percent_format has more arguments</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">100</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">accuracy =</span> <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="limit-axis-range" class="level2">
<h2 class="anchored" data-anchor-id="limit-axis-range">Limit axis range</h2>
<p><code>ggplot</code> provides several ways to limit the range of the axes, and the effect on the plot will depend on which approach is chosen. More specifically, the <code>xlim()</code> and <code>ylim()</code> functions will replace all values that are out of range by NA, while e.g.&nbsp;<code>coord_cartesian(xlim = ...)</code> keeps all the data for any calculations, and just adjusts the displayed range. In addition to appearance, the distinction is important e.g.&nbsp;when calculating summary statistics, smoothing curves etc from the data.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## xlim()/ylim() will replace out-of-range data by NA</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">11</span>, <span class="dv">59</span>) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 46 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 46 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## coord_cartesian() just sets the displayed range</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">59</span>)) <span class="sc">+</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="interactive-plots" class="level1">
<h1>Interactive plots</h1>
<p>Interactive plots can be very helpful for exploratory purposes, and can be directly embedded in R Markdown or Quarto reports. However, it is worth noting that they do inflate the size of the report (sometimes dramatically, if the number of points is very large). Here we will illustrate a few different approaches to making interactive “<code>ggplot</code>-like” graphics.</p>
<section id="ggplotly" class="level2">
<h2 class="anchored" data-anchor-id="ggplotly">(gg)plotly</h2>
<p>First, we use the <code>ggplotly</code> function from the <code>plotly</code> package, which can be used to turn a <code>ggplot</code> object into an interactive plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Turn a ggplot into an interactive plot with ggplotly</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">label =</span> make)) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        ggp,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"label"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-aa116dc0355847c8189b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-aa116dc0355847c8189b">{"x":{"data":[{"x":[21,22,22,24,31,28,31,26,26,27,28,18,16,17,16,16,27,29,26,30,31,28,26,24,24,28,27,24,28,26,24,27,26,24,24,28,27,24,24,22,22,19,21,20,19,20,21,20,21,20,20,27,26,24,26,26,23,13,13,16,27,25,25,24,27,25,28,27,25,25,24,24,24,27,25,27,26,23,25,27,25,27,27,23,26,26,27,27,26,23,24,22,23,24,22,21,24,21,24,24,21,21,22,21,21,20,22,22,23,21,20,19,20,20,26,26,27,25,27,27,25,27,27,26,27,20,19,19,17,22,23,24,24,21,23,18,25,25,24,24,21,22,24,19,17,16,16,16,18,20,22,19,21,19,23,23,21,23,20,19,20,18,16,16,18,17,31,32,31,32,20,20,18,17,31,33,31,27,29,31,23,24,22,23,21,22,21,22,23,24,22,21,22,21,24,26,25,23,23,17,18,17,29,26,27,27,32,29,28,29,26,28,28,27,28,27,26,27,19,18,19,20,19,19,19,18,19,17,18,18,18,17,17,15,12,11,11,18,19,18,18,17,17,19,19,18,19,18,17,18,17,20,19,18,19,17,18,21,23,17,17,17,19,19,17,24,22,22,26,25,23,18,25,22,23,25,22,23,21,23,20,24,24,25,26,24,24,25,26,26,29,25,27,25,27,25,25,27,25,25,24,23,23,24,24,23,23,20,20,18,19,18,19,19,18,19,17,17,17,17,26,25,23,22,22,29,32,28,19,20,17,17,11,14,14,17,17,16,14,16,26,29,25,27,25,27,25,25,19,15,15,15,16,15,16,15,16,23,20,17,15,18,16,17,23,27,23,20,24,20,28,26,18,17,19,18,19,18,17,18,19,18,18,19,18,17,16,17,23,25,26,29,32,28,29,32,22,21,22,21,22,25,19,23,26,22,23,24,27,21,21,21,21,19,19,18,17,25,25,25,23,24,24,22,22,23,24,22,23,21,22,21,22,23,24,22,21,22,21,20,19,19,17,18,19,17,18,18,19,17,18,20,20,19,18,16,16,17,17,17,17,18,19,18,17,17,19,18,20,20,19,19,19,18,19,17,18,18,18,17,17,15,12,11,11,19,19,18,19,18,17,18,16,17,18,17,16,17,31,31,28,27,33,36,34,35,34,39,34,28,31,43,42,45,45,26,25,24,24,23,23,22,49,58,26,23,20,23,32,33,32,30,29,31,24,25,23,22,21,21,27,28,25,25,27,28,24,24,24,25,25,24,24,23,24,20,22,18,24,23,22,23,22,18,17,20,19,18,19,19,18,24,24,25,22,22,25,24,25,23,25,24,25,23,25,25,25,22,24,24,21,21,21,18,18,19,18,19,24,20,20,22,20,20,24,19,16,17,23,28,27,25,26,29,29,21,20,19,18,18,31,30,25,25,23,24,21,14,16,12,14,19,18,17,15,27,23,22,18,23,23,23,16,23,23,22,22,22,17,16,24,24,22,22,17,23,25,15,16,14,15,16,16,16,32,31,29,26,28,26,24,25,24,25,24,27,21,21,21,21,18,17,23,26,26,26,24,22,22,23,27,23,20,24,20,29,29,29,28,23,22,23,23,24,24,24,22,22,20,22,20,17,18,26,24,23,23,21,21,26,25,23,22,33,23,19,18,19,19,13,13,17,16,24,21,22,20,20,17,21,18,18,18,23,23,20,16,23,24,23,21,21,23,25,26,21,19,18,19,17,17,19,17,25,25,25,23,24,24,31,33,30,32,29,29,29,29,23,25,28,25,27,26,25,25,28,24,26,26,25,25,21,20,27,25,28,31,26,27,24,23,26,17,25,24,25,23,24,23,23,24,23,27,29,25,26,28,18,17,22,23,19,20,19,19,27,26,23,23,21,19,24,23,31,32,26,27,17,17,17,17,20,21,19,19,22,24,27,22,29,26,31,27,26,27,24,25,23,19,21,23,24,31,32,31,29,33,29,31,32,31,32,27,26,24,25,24,21,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,22,22,22,22,22,22,22,22,21,22,21,22,15,18,19,17,17,24,24,24,24,22,20,21,20,21,20,20,20,20,20,20,20,21,17,23,24,26,27,26,25,29,28,26,28,28,26,28,26,19,17,27,29,32,26,26,21,23,24,23,26,25,27,25,27,27,35,34,32,31,18,18,18,25,23,25,21,22,26,22,27,24,25,26,27,22,24,25,26,27,23,27,27,23,23,27,27,23,23,23,26,26,23,23,28,28,26,28,28,26,28,27,26,27,20,21,20,20,21,20,20,20,28,27,31,32,31,32,25,20,18,19,18,28,31,30,26,27,29,30,27,26,33,30,30,28,35,37,31,36,38,25,23,23,22,16,31,29,33,29,29,30,45,27,27,24,25,17,16,24,22,24,25,21,19,21,20,18,20,19,17,17,41,39,28,28,29,27,27,29,27,27,41,39,28,28,28,28,39,38,29,27,39,39,27,28,28,28,41,38,28,28,28,28,28,28,28,28,34,26,25,28,26,24,28,28,34,26,25,28,26,24,21,17,19,17,25,25,27,27,29,27,24,27,27,26,26,27,23,22,24,27,24,25,24,27,27,29,27,24,26,27,24,24,27,23,22,22,20,19,19,21],"y":[15,16,16,16,24,20,22,18,18,19,20,11,10,11,10,10,20,20,19,21,20,19,18,16,16,20,19,17,20,18,16,19,18,16,16,20,19,17,17,16,16,13,14,15,14,13,14,13,14,13,14,18,18,17,18,18,17,9,9,10,18,17,17,16,18,17,19,18,17,17,17,17,17,18,17,18,17,16,17,18,17,18,18,16,17,17,18,18,17,15,16,15,15,16,15,13,16,13,16,16,13,13,15,15,14,14,15,15,15,14,13,14,14,14,18,18,18,17,18,18,17,18,18,17,18,14,14,14,14,16,16,17,16,15,16,13,16,16,15,16,13,15,16,14,13,12,12,12,13,13,15,14,14,14,16,15,14,15,15,14,14,14,12,12,13,13,23,23,23,23,15,14,14,13,21,23,22,20,21,22,16,18,16,17,15,17,16,17,16,18,16,15,17,16,16,16,18,17,17,13,13,13,19,17,18,17,21,20,20,19,17,18,20,20,20,20,18,18,16,15,14,14,15,14,14,13,14,13,13,14,14,13,13,12,10,8,8,14,12,14,13,13,13,14,14,14,14,13,13,13,13,14,14,13,13,12,13,15,16,13,13,13,14,14,13,17,15,15,18,17,15,13,19,15,15,19,15,15,15,16,15,17,19,19,19,17,19,19,19,19,21,18,18,18,20,19,19,20,19,19,17,16,16,17,17,16,16,15,14,14,13,14,15,14,13,14,13,12,12,12,18,17,15,15,15,22,25,19,14,14,13,12,8,9,11,13,12,12,11,12,19,21,18,18,18,20,19,19,11,10,10,9,9,10,9,10,10,16,14,13,12,13,13,13,19,21,17,17,19,16,30,28,13,13,14,13,13,13,13,13,13,13,14,13,13,13,12,13,17,18,19,22,22,20,22,22,16,16,16,16,17,18,12,17,17,16,15,19,21,16,16,15,16,15,15,14,14,18,18,17,17,17,17,16,16,16,18,16,17,15,17,16,17,16,18,16,15,17,16,14,14,14,14,13,13,12,13,13,14,12,13,15,14,14,14,12,12,13,13,13,13,14,14,13,13,13,16,15,14,14,15,14,14,13,14,13,13,14,14,13,13,12,10,8,8,14,14,14,14,13,13,13,12,13,13,13,12,13,21,23,19,18,25,29,25,26,27,31,27,22,26,39,39,37,38,20,20,19,19,19,19,18,45,48,17,17,15,17,23,24,23,25,21,23,18,18,17,16,16,15,19,20,17,18,19,21,17,17,16,19,20,18,19,17,16,15,15,14,17,16,16,16,16,12,12,14,14,13,13,14,13,16,16,16,15,15,16,16,17,16,16,17,17,16,16,16,16,15,16,16,14,14,15,14,13,15,13,14,18,15,16,18,15,16,19,16,13,13,15,19,20,18,18,21,22,14,14,15,13,14,21,22,19,20,17,19,17,8,9,8,9,16,13,13,11,18,16,16,14,16,16,16,12,17,17,16,16,16,11,11,17,17,16,16,11,16,20,10,11,11,10,11,11,11,24,23,22,21,21,20,17,17,17,17,19,21,16,16,15,16,14,14,16,20,20,20,18,16,16,19,21,17,17,19,16,21,20,21,21,17,17,17,17,17,17,18,16,17,14,14,13,12,11,18,18,15,15,14,14,18,17,17,16,23,15,14,14,13,13,11,11,14,13,16,15,14,14,13,11,14,12,11,11,17,16,14,12,16,19,17,17,16,17,18,19,16,14,13,13,13,13,13,13,18,18,17,17,17,17,23,24,23,24,22,21,22,21,15,19,20,19,18,18,18,18,20,18,18,18,18,18,16,15,20,17,22,24,20,20,17,17,20,13,19,19,18,18,17,17,17,17,16,21,21,19,18,18,12,12,17,19,14,15,14,15,18,18,18,18,14,14,17,16,24,24,20,20,13,13,12,12,14,15,14,15,16,17,18,15,20,19,22,18,17,18,16,16,15,14,15,16,17,21,23,25,22,26,22,23,23,23,23,18,18,16,17,16,14,17,16,16,16,16,16,17,16,16,16,16,16,17,16,17,16,15,15,15,15,15,15,15,15,15,15,15,15,9,14,13,12,12,16,16,16,16,14,13,14,13,14,13,13,13,13,13,13,13,14,11,17,17,20,20,19,17,19,19,19,19,18,17,18,17,14,14,20,21,23,18,18,15,16,19,17,20,19,20,18,20,19,27,27,27,27,13,13,13,19,17,19,16,18,20,17,20,17,18,20,20,16,17,18,20,20,17,20,20,17,17,20,20,17,17,17,20,20,17,17,22,22,21,22,22,21,20,20,18,18,17,17,17,17,16,15,15,15,20,20,23,23,23,23,18,16,15,15,14,19,21,21,18,18,20,21,18,18,25,23,21,22,26,28,22,28,30,19,17,19,16,12,25,22,26,22,23,23,48,21,21,20,19,14,13,17,16,18,18,16,14,17,16,14,16,14,14,13,32,28,21,21,21,19,19,21,19,19,32,28,21,21,19,19,31,30,21,19,31,28,20,21,22,19,32,30,21,19,22,19,21,19,19,19,23,17,17,19,18,17,19,19,23,17,17,19,18,17,14,11,14,12,17,18,19,19,19,19,17,19,19,18,18,19,16,16,17,18,16,17,17,19,19,19,19,17,18,19,17,17,18,16,16,16,15,14,13,16],"text":["hwy: 21<br />cty: 15<br />make: Acura","hwy: 22<br />cty: 16<br />make: Acura","hwy: 22<br />cty: 16<br />make: Acura","hwy: 24<br />cty: 16<br />make: Acura","hwy: 31<br />cty: 24<br />make: Acura","hwy: 28<br />cty: 20<br />make: Acura","hwy: 31<br />cty: 22<br />make: Acura","hwy: 26<br />cty: 18<br />make: Acura","hwy: 26<br />cty: 18<br />make: Acura","hwy: 27<br />cty: 19<br />make: Acura","hwy: 28<br />cty: 20<br />make: Acura","hwy: 18<br />cty: 11<br />make: Aston Martin","hwy: 16<br />cty: 10<br />make: Aston Martin","hwy: 17<br />cty: 11<br />make: Aston Martin","hwy: 16<br />cty: 10<br />make: Aston Martin","hwy: 16<br />cty: 10<br />make: Aston Martin","hwy: 27<br />cty: 20<br />make: Audi","hwy: 29<br />cty: 20<br />make: Audi","hwy: 26<br />cty: 19<br />make: Audi","hwy: 30<br />cty: 21<br />make: Audi","hwy: 31<br />cty: 20<br />make: Audi","hwy: 28<br />cty: 19<br />make: Audi","hwy: 26<br />cty: 18<br />make: Audi","hwy: 24<br />cty: 16<br />make: Audi","hwy: 24<br />cty: 16<br />make: Audi","hwy: 28<br />cty: 20<br />make: Audi","hwy: 27<br />cty: 19<br />make: Audi","hwy: 24<br />cty: 17<br />make: Audi","hwy: 28<br />cty: 20<br />make: Audi","hwy: 26<br />cty: 18<br />make: Audi","hwy: 24<br />cty: 16<br />make: Audi","hwy: 27<br />cty: 19<br />make: Audi","hwy: 26<br />cty: 18<br />make: Audi","hwy: 24<br />cty: 16<br />make: Audi","hwy: 24<br />cty: 16<br />make: Audi","hwy: 28<br />cty: 20<br />make: Audi","hwy: 27<br />cty: 19<br />make: Audi","hwy: 24<br />cty: 17<br />make: Audi","hwy: 24<br />cty: 17<br />make: Audi","hwy: 22<br />cty: 16<br />make: Audi","hwy: 22<br />cty: 16<br />make: Audi","hwy: 19<br />cty: 13<br />make: Audi","hwy: 21<br />cty: 14<br />make: Audi","hwy: 20<br />cty: 15<br />make: Audi","hwy: 19<br />cty: 14<br />make: Audi","hwy: 20<br />cty: 13<br />make: Audi","hwy: 21<br />cty: 14<br />make: Audi","hwy: 20<br />cty: 13<br />make: Audi","hwy: 21<br />cty: 14<br />make: Audi","hwy: 20<br />cty: 13<br />make: Audi","hwy: 20<br />cty: 14<br />make: Audi","hwy: 27<br />cty: 18<br />make: Audi","hwy: 26<br />cty: 18<br />make: Audi","hwy: 24<br />cty: 17<br />make: Audi","hwy: 26<br />cty: 18<br />make: Audi","hwy: 26<br />cty: 18<br />make: Audi","hwy: 23<br />cty: 17<br />make: Audi","hwy: 13<br />cty:  9<br />make: Bentley","hwy: 13<br />cty:  9<br />make: Bentley","hwy: 16<br />cty: 10<br />make: Bentley","hwy: 27<br />cty: 18<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 24<br />cty: 16<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 28<br />cty: 19<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 24<br />cty: 17<br />make: BMW","hwy: 24<br />cty: 17<br />make: BMW","hwy: 24<br />cty: 17<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 26<br />cty: 17<br />make: BMW","hwy: 23<br />cty: 16<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 23<br />cty: 16<br />make: BMW","hwy: 26<br />cty: 17<br />make: BMW","hwy: 26<br />cty: 17<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 26<br />cty: 17<br />make: BMW","hwy: 23<br />cty: 15<br />make: BMW","hwy: 24<br />cty: 16<br />make: BMW","hwy: 22<br />cty: 15<br />make: BMW","hwy: 23<br />cty: 15<br />make: BMW","hwy: 24<br />cty: 16<br />make: BMW","hwy: 22<br />cty: 15<br />make: BMW","hwy: 21<br />cty: 13<br />make: BMW","hwy: 24<br />cty: 16<br />make: BMW","hwy: 21<br />cty: 13<br />make: BMW","hwy: 24<br />cty: 16<br />make: BMW","hwy: 24<br />cty: 16<br />make: BMW","hwy: 21<br />cty: 13<br />make: BMW","hwy: 21<br />cty: 13<br />make: BMW","hwy: 22<br />cty: 15<br />make: BMW","hwy: 21<br />cty: 15<br />make: BMW","hwy: 21<br />cty: 14<br />make: BMW","hwy: 20<br />cty: 14<br />make: BMW","hwy: 22<br />cty: 15<br />make: BMW","hwy: 22<br />cty: 15<br />make: BMW","hwy: 23<br />cty: 15<br />make: BMW","hwy: 21<br />cty: 14<br />make: BMW","hwy: 20<br />cty: 13<br />make: BMW","hwy: 19<br />cty: 14<br />make: BMW","hwy: 20<br />cty: 14<br />make: BMW","hwy: 20<br />cty: 14<br />make: BMW","hwy: 26<br />cty: 18<br />make: BMW","hwy: 26<br />cty: 18<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 25<br />cty: 17<br />make: BMW","hwy: 27<br />cty: 18<br />make: BMW","hwy: 27<br />cty: 18<br />make: Buick","hwy: 25<br />cty: 17<br />make: Buick","hwy: 27<br />cty: 18<br />make: Buick","hwy: 27<br />cty: 18<br />make: Buick","hwy: 26<br />cty: 17<br />make: Buick","hwy: 27<br />cty: 18<br />make: Buick","hwy: 20<br />cty: 14<br />make: Buick","hwy: 19<br />cty: 14<br />make: Buick","hwy: 19<br />cty: 14<br />make: Buick","hwy: 17<br />cty: 14<br />make: Buick","hwy: 22<br />cty: 16<br />make: Buick","hwy: 23<br />cty: 16<br />make: Buick","hwy: 24<br />cty: 17<br />make: Buick","hwy: 24<br />cty: 16<br />make: Buick","hwy: 21<br />cty: 15<br />make: Buick","hwy: 23<br />cty: 16<br />make: Buick","hwy: 18<br />cty: 13<br />make: Cadillac","hwy: 25<br />cty: 16<br />make: Cadillac","hwy: 25<br />cty: 16<br />make: Cadillac","hwy: 24<br />cty: 15<br />make: Cadillac","hwy: 24<br />cty: 16<br />make: Cadillac","hwy: 21<br />cty: 13<br />make: Cadillac","hwy: 22<br />cty: 15<br />make: Cadillac","hwy: 24<br />cty: 16<br />make: Cadillac","hwy: 19<br />cty: 14<br />make: Cadillac","hwy: 17<br />cty: 13<br />make: Cadillac","hwy: 16<br />cty: 12<br />make: Cadillac","hwy: 16<br />cty: 12<br />make: Cadillac","hwy: 16<br />cty: 12<br />make: Cadillac","hwy: 18<br />cty: 13<br />make: Cadillac","hwy: 20<br />cty: 13<br />make: Cadillac","hwy: 22<br />cty: 15<br />make: Cadillac","hwy: 19<br />cty: 14<br />make: Cadillac","hwy: 21<br />cty: 14<br />make: Cadillac","hwy: 19<br />cty: 14<br />make: Cadillac","hwy: 23<br />cty: 16<br />make: Cadillac","hwy: 23<br />cty: 15<br />make: Cadillac","hwy: 21<br />cty: 14<br />make: Cadillac","hwy: 23<br />cty: 15<br />make: Cadillac","hwy: 20<br />cty: 15<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 20<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 16<br />cty: 12<br />make: Chevrolet","hwy: 16<br />cty: 12<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 31<br />cty: 23<br />make: Chevrolet","hwy: 32<br />cty: 23<br />make: Chevrolet","hwy: 31<br />cty: 23<br />make: Chevrolet","hwy: 32<br />cty: 23<br />make: Chevrolet","hwy: 20<br />cty: 15<br />make: Chevrolet","hwy: 20<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 31<br />cty: 21<br />make: Chevrolet","hwy: 33<br />cty: 23<br />make: Chevrolet","hwy: 31<br />cty: 22<br />make: Chevrolet","hwy: 27<br />cty: 20<br />make: Chevrolet","hwy: 29<br />cty: 21<br />make: Chevrolet","hwy: 31<br />cty: 22<br />make: Chevrolet","hwy: 23<br />cty: 16<br />make: Chevrolet","hwy: 24<br />cty: 18<br />make: Chevrolet","hwy: 22<br />cty: 16<br />make: Chevrolet","hwy: 23<br />cty: 17<br />make: Chevrolet","hwy: 21<br />cty: 15<br />make: Chevrolet","hwy: 22<br />cty: 17<br />make: Chevrolet","hwy: 21<br />cty: 16<br />make: Chevrolet","hwy: 22<br />cty: 17<br />make: Chevrolet","hwy: 23<br />cty: 16<br />make: Chevrolet","hwy: 24<br />cty: 18<br />make: Chevrolet","hwy: 22<br />cty: 16<br />make: Chevrolet","hwy: 21<br />cty: 15<br />make: Chevrolet","hwy: 22<br />cty: 17<br />make: Chevrolet","hwy: 21<br />cty: 16<br />make: Chevrolet","hwy: 24<br />cty: 16<br />make: Chevrolet","hwy: 26<br />cty: 16<br />make: Chevrolet","hwy: 25<br />cty: 18<br />make: Chevrolet","hwy: 23<br />cty: 17<br />make: Chevrolet","hwy: 23<br />cty: 17<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 29<br />cty: 19<br />make: Chevrolet","hwy: 26<br />cty: 17<br />make: Chevrolet","hwy: 27<br />cty: 18<br />make: Chevrolet","hwy: 27<br />cty: 17<br />make: Chevrolet","hwy: 32<br />cty: 21<br />make: Chevrolet","hwy: 29<br />cty: 20<br />make: Chevrolet","hwy: 28<br />cty: 20<br />make: Chevrolet","hwy: 29<br />cty: 19<br />make: Chevrolet","hwy: 26<br />cty: 17<br />make: Chevrolet","hwy: 28<br />cty: 18<br />make: Chevrolet","hwy: 28<br />cty: 20<br />make: Chevrolet","hwy: 27<br />cty: 20<br />make: Chevrolet","hwy: 28<br />cty: 20<br />make: Chevrolet","hwy: 27<br />cty: 20<br />make: Chevrolet","hwy: 26<br />cty: 18<br />make: Chevrolet","hwy: 27<br />cty: 18<br />make: Chevrolet","hwy: 19<br />cty: 16<br />make: Chevrolet","hwy: 18<br />cty: 15<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 20<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 15<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 15<br />cty: 12<br />make: Chevrolet","hwy: 12<br />cty: 10<br />make: Chevrolet","hwy: 11<br />cty:  8<br />make: Chevrolet","hwy: 11<br />cty:  8<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 12<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 20<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 19<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 12<br />make: Chevrolet","hwy: 18<br />cty: 13<br />make: Chevrolet","hwy: 21<br />cty: 15<br />make: Chevrolet","hwy: 23<br />cty: 16<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 19<br />cty: 14<br />make: Chevrolet","hwy: 17<br />cty: 13<br />make: Chevrolet","hwy: 24<br />cty: 17<br />make: Chevrolet","hwy: 22<br />cty: 15<br />make: Chrysler","hwy: 22<br />cty: 15<br />make: Chrysler","hwy: 26<br />cty: 18<br />make: Chrysler","hwy: 25<br />cty: 17<br />make: Chrysler","hwy: 23<br />cty: 15<br />make: Chrysler","hwy: 18<br />cty: 13<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 22<br />cty: 15<br />make: Chrysler","hwy: 23<br />cty: 15<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 22<br />cty: 15<br />make: Chrysler","hwy: 23<br />cty: 15<br />make: Chrysler","hwy: 21<br />cty: 15<br />make: Chrysler","hwy: 23<br />cty: 16<br />make: Chrysler","hwy: 20<br />cty: 15<br />make: Chrysler","hwy: 24<br />cty: 17<br />make: Chrysler","hwy: 24<br />cty: 19<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 26<br />cty: 19<br />make: Chrysler","hwy: 24<br />cty: 17<br />make: Chrysler","hwy: 24<br />cty: 19<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 26<br />cty: 19<br />make: Chrysler","hwy: 26<br />cty: 19<br />make: Chrysler","hwy: 29<br />cty: 21<br />make: Chrysler","hwy: 25<br />cty: 18<br />make: Chrysler","hwy: 27<br />cty: 18<br />make: Chrysler","hwy: 25<br />cty: 18<br />make: Chrysler","hwy: 27<br />cty: 20<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 27<br />cty: 20<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 25<br />cty: 19<br />make: Chrysler","hwy: 24<br />cty: 17<br />make: Chrysler","hwy: 23<br />cty: 16<br />make: Chrysler","hwy: 23<br />cty: 16<br />make: Chrysler","hwy: 24<br />cty: 17<br />make: Dodge","hwy: 24<br />cty: 17<br />make: Dodge","hwy: 23<br />cty: 16<br />make: Dodge","hwy: 23<br />cty: 16<br />make: Dodge","hwy: 20<br />cty: 15<br />make: Dodge","hwy: 20<br />cty: 14<br />make: Dodge","hwy: 18<br />cty: 14<br />make: Dodge","hwy: 19<br />cty: 13<br />make: Dodge","hwy: 18<br />cty: 14<br />make: Dodge","hwy: 19<br />cty: 15<br />make: Dodge","hwy: 19<br />cty: 14<br />make: Dodge","hwy: 18<br />cty: 13<br />make: Dodge","hwy: 19<br />cty: 14<br />make: Dodge","hwy: 17<br />cty: 13<br />make: Dodge","hwy: 17<br />cty: 12<br />make: Dodge","hwy: 17<br />cty: 12<br />make: Dodge","hwy: 17<br />cty: 12<br />make: Dodge","hwy: 26<br />cty: 18<br />make: Dodge","hwy: 25<br />cty: 17<br />make: Dodge","hwy: 23<br />cty: 15<br />make: Dodge","hwy: 22<br />cty: 15<br />make: Dodge","hwy: 22<br />cty: 15<br />make: Dodge","hwy: 29<br />cty: 22<br />make: Dodge","hwy: 32<br />cty: 25<br />make: Dodge","hwy: 28<br />cty: 19<br />make: Dodge","hwy: 19<br />cty: 14<br />make: Dodge","hwy: 20<br />cty: 14<br />make: Dodge","hwy: 17<br />cty: 13<br />make: Dodge","hwy: 17<br />cty: 12<br />make: Dodge","hwy: 11<br />cty:  8<br />make: Dodge","hwy: 14<br />cty:  9<br />make: Dodge","hwy: 14<br />cty: 11<br />make: Dodge","hwy: 17<br />cty: 13<br />make: Dodge","hwy: 17<br />cty: 12<br />make: Dodge","hwy: 16<br />cty: 12<br />make: Dodge","hwy: 14<br />cty: 11<br />make: Dodge","hwy: 16<br />cty: 12<br />make: Dodge","hwy: 26<br />cty: 19<br />make: Dodge","hwy: 29<br />cty: 21<br />make: Dodge","hwy: 25<br />cty: 18<br />make: Dodge","hwy: 27<br />cty: 18<br />make: Dodge","hwy: 25<br />cty: 18<br />make: Dodge","hwy: 27<br />cty: 20<br />make: Dodge","hwy: 25<br />cty: 19<br />make: Dodge","hwy: 25<br />cty: 19<br />make: Dodge","hwy: 19<br />cty: 11<br />make: Dodge","hwy: 15<br />cty: 10<br />make: Ferrari","hwy: 15<br />cty: 10<br />make: Ferrari","hwy: 15<br />cty:  9<br />make: Ferrari","hwy: 16<br />cty:  9<br />make: Ferrari","hwy: 15<br />cty: 10<br />make: Ferrari","hwy: 16<br />cty:  9<br />make: Ferrari","hwy: 15<br />cty: 10<br />make: Ferrari","hwy: 16<br />cty: 10<br />make: Ferrari","hwy: 23<br />cty: 16<br />make: Ford","hwy: 20<br />cty: 14<br />make: Ford","hwy: 17<br />cty: 13<br />make: Ford","hwy: 15<br />cty: 12<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 16<br />cty: 13<br />make: Ford","hwy: 17<br />cty: 13<br />make: Ford","hwy: 23<br />cty: 19<br />make: Ford","hwy: 27<br />cty: 21<br />make: Ford","hwy: 23<br />cty: 17<br />make: Ford","hwy: 20<br />cty: 17<br />make: Ford","hwy: 24<br />cty: 19<br />make: Ford","hwy: 20<br />cty: 16<br />make: Ford","hwy: 28<br />cty: 30<br />make: Ford","hwy: 26<br />cty: 28<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 17<br />cty: 13<br />make: Ford","hwy: 19<br />cty: 14<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 19<br />cty: 13<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 17<br />cty: 13<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 19<br />cty: 13<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 18<br />cty: 14<br />make: Ford","hwy: 19<br />cty: 13<br />make: Ford","hwy: 18<br />cty: 13<br />make: Ford","hwy: 17<br />cty: 13<br />make: Ford","hwy: 16<br />cty: 12<br />make: Ford","hwy: 17<br />cty: 13<br />make: Ford","hwy: 23<br />cty: 17<br />make: Ford","hwy: 25<br />cty: 18<br />make: Ford","hwy: 26<br />cty: 19<br />make: Ford","hwy: 29<br />cty: 22<br />make: Ford","hwy: 32<br />cty: 22<br />make: Ford","hwy: 28<br />cty: 20<br />make: Ford","hwy: 29<br />cty: 22<br />make: Ford","hwy: 32<br />cty: 22<br />make: Ford","hwy: 22<br />cty: 16<br />make: Ford","hwy: 21<br />cty: 16<br />make: Ford","hwy: 22<br />cty: 16<br />make: Ford","hwy: 21<br />cty: 16<br />make: Ford","hwy: 22<br />cty: 17<br />make: Ford","hwy: 25<br />cty: 18<br />make: Ford","hwy: 19<br />cty: 12<br />make: Ford","hwy: 23<br />cty: 17<br />make: Ford","hwy: 26<br />cty: 17<br />make: Ford","hwy: 22<br />cty: 16<br />make: Ford","hwy: 23<br />cty: 15<br />make: Ford","hwy: 24<br />cty: 19<br />make: Ford","hwy: 27<br />cty: 21<br />make: Ford","hwy: 21<br />cty: 16<br />make: Ford","hwy: 21<br />cty: 16<br />make: Ford","hwy: 21<br />cty: 15<br />make: Ford","hwy: 21<br />cty: 16<br />make: Ford","hwy: 19<br />cty: 15<br />make: Ford","hwy: 19<br />cty: 15<br />make: Ford","hwy: 18<br />cty: 14<br />make: Ford","hwy: 17<br />cty: 14<br />make: Ford","hwy: 25<br />cty: 18<br />make: Ford","hwy: 25<br />cty: 18<br />make: Ford","hwy: 25<br />cty: 17<br />make: Ford","hwy: 23<br />cty: 17<br />make: Ford","hwy: 24<br />cty: 17<br />make: Ford","hwy: 24<br />cty: 17<br />make: Ford","hwy: 22<br />cty: 16<br />make: Ford","hwy: 22<br />cty: 16<br />make: Ford","hwy: 23<br />cty: 16<br />make: GMC","hwy: 24<br />cty: 18<br />make: GMC","hwy: 22<br />cty: 16<br />make: GMC","hwy: 23<br />cty: 17<br />make: GMC","hwy: 21<br />cty: 15<br />make: GMC","hwy: 22<br />cty: 17<br />make: GMC","hwy: 21<br />cty: 16<br />make: GMC","hwy: 22<br />cty: 17<br />make: GMC","hwy: 23<br />cty: 16<br />make: GMC","hwy: 24<br />cty: 18<br />make: GMC","hwy: 22<br />cty: 16<br />make: GMC","hwy: 21<br />cty: 15<br />make: GMC","hwy: 22<br />cty: 17<br />make: GMC","hwy: 21<br />cty: 16<br />make: GMC","hwy: 20<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 17<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 19<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 12<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 17<br />cty: 12<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 20<br />cty: 15<br />make: GMC","hwy: 20<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 14<br />make: GMC","hwy: 16<br />cty: 12<br />make: GMC","hwy: 16<br />cty: 12<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 18<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 19<br />cty: 16<br />make: GMC","hwy: 18<br />cty: 15<br />make: GMC","hwy: 20<br />cty: 14<br />make: GMC","hwy: 20<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 15<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 18<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 14<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 15<br />cty: 12<br />make: GMC","hwy: 12<br />cty: 10<br />make: GMC","hwy: 11<br />cty:  8<br />make: GMC","hwy: 11<br />cty:  8<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 14<br />make: GMC","hwy: 19<br />cty: 14<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 16<br />cty: 12<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 18<br />cty: 13<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 16<br />cty: 12<br />make: GMC","hwy: 17<br />cty: 13<br />make: GMC","hwy: 31<br />cty: 21<br />make: Honda","hwy: 31<br />cty: 23<br />make: Honda","hwy: 28<br />cty: 19<br />make: Honda","hwy: 27<br />cty: 18<br />make: Honda","hwy: 33<br />cty: 25<br />make: Honda","hwy: 36<br />cty: 29<br />make: Honda","hwy: 34<br />cty: 25<br />make: Honda","hwy: 35<br />cty: 26<br />make: Honda","hwy: 34<br />cty: 27<br />make: Honda","hwy: 39<br />cty: 31<br />make: Honda","hwy: 34<br />cty: 27<br />make: Honda","hwy: 28<br />cty: 22<br />make: Honda","hwy: 31<br />cty: 26<br />make: Honda","hwy: 43<br />cty: 39<br />make: Honda","hwy: 42<br />cty: 39<br />make: Honda","hwy: 45<br />cty: 37<br />make: Honda","hwy: 45<br />cty: 38<br />make: Honda","hwy: 26<br />cty: 20<br />make: Honda","hwy: 25<br />cty: 20<br />make: Honda","hwy: 24<br />cty: 19<br />make: Honda","hwy: 24<br />cty: 19<br />make: Honda","hwy: 23<br />cty: 19<br />make: Honda","hwy: 23<br />cty: 19<br />make: Honda","hwy: 22<br />cty: 18<br />make: Honda","hwy: 49<br />cty: 45<br />make: Honda","hwy: 58<br />cty: 48<br />make: Honda","hwy: 26<br />cty: 17<br />make: Honda","hwy: 23<br />cty: 17<br />make: Honda","hwy: 20<br />cty: 15<br />make: Honda","hwy: 23<br />cty: 17<br />make: Honda","hwy: 32<br />cty: 23<br />make: Hyundai","hwy: 33<br />cty: 24<br />make: Hyundai","hwy: 32<br />cty: 23<br />make: Hyundai","hwy: 30<br />cty: 25<br />make: Hyundai","hwy: 29<br />cty: 21<br />make: Hyundai","hwy: 31<br />cty: 23<br />make: Hyundai","hwy: 24<br />cty: 18<br />make: Hyundai","hwy: 25<br />cty: 18<br />make: Hyundai","hwy: 23<br />cty: 17<br />make: Hyundai","hwy: 22<br />cty: 16<br />make: Hyundai","hwy: 21<br />cty: 16<br />make: Hyundai","hwy: 21<br />cty: 15<br />make: Hyundai","hwy: 27<br />cty: 19<br />make: Hyundai","hwy: 28<br />cty: 20<br />make: Hyundai","hwy: 25<br />cty: 17<br />make: Hyundai","hwy: 25<br />cty: 18<br />make: Hyundai","hwy: 27<br />cty: 19<br />make: Hyundai","hwy: 28<br />cty: 21<br />make: Hyundai","hwy: 24<br />cty: 17<br />make: Hyundai","hwy: 24<br />cty: 17<br />make: Hyundai","hwy: 24<br />cty: 16<br />make: Hyundai","hwy: 25<br />cty: 19<br />make: Hyundai","hwy: 25<br />cty: 20<br />make: Hyundai","hwy: 24<br />cty: 18<br />make: Hyundai","hwy: 24<br />cty: 19<br />make: Hyundai","hwy: 23<br />cty: 17<br />make: Hyundai","hwy: 24<br />cty: 16<br />make: Hyundai","hwy: 20<br />cty: 15<br />make: Infiniti","hwy: 22<br />cty: 15<br />make: Infiniti","hwy: 18<br />cty: 14<br />make: Infiniti","hwy: 24<br />cty: 17<br />make: Infiniti","hwy: 23<br />cty: 16<br />make: Infiniti","hwy: 22<br />cty: 16<br />make: Infiniti","hwy: 23<br />cty: 16<br />make: Infiniti","hwy: 22<br />cty: 16<br />make: Infiniti","hwy: 18<br />cty: 12<br />make: Infiniti","hwy: 17<br />cty: 12<br />make: Infiniti","hwy: 20<br />cty: 14<br />make: Isuzu","hwy: 19<br />cty: 14<br />make: Isuzu","hwy: 18<br />cty: 13<br />make: Isuzu","hwy: 19<br />cty: 13<br />make: Isuzu","hwy: 19<br />cty: 14<br />make: Isuzu","hwy: 18<br />cty: 13<br />make: Isuzu","hwy: 24<br />cty: 16<br />make: Jaguar","hwy: 24<br />cty: 16<br />make: Jaguar","hwy: 25<br />cty: 16<br />make: Jaguar","hwy: 22<br />cty: 15<br />make: Jaguar","hwy: 22<br />cty: 15<br />make: Jaguar","hwy: 25<br />cty: 16<br />make: Jaguar","hwy: 24<br />cty: 16<br />make: Jaguar","hwy: 25<br />cty: 17<br />make: Jaguar","hwy: 23<br />cty: 16<br />make: Jaguar","hwy: 25<br />cty: 16<br />make: Jaguar","hwy: 24<br />cty: 17<br />make: Jaguar","hwy: 25<br />cty: 17<br />make: Jaguar","hwy: 23<br />cty: 16<br />make: Jaguar","hwy: 25<br />cty: 16<br />make: Jaguar","hwy: 25<br />cty: 16<br />make: Jaguar","hwy: 25<br />cty: 16<br />make: Jaguar","hwy: 22<br />cty: 15<br />make: Jaguar","hwy: 24<br />cty: 16<br />make: Jaguar","hwy: 24<br />cty: 16<br />make: Jaguar","hwy: 21<br />cty: 14<br />make: Jaguar","hwy: 21<br />cty: 14<br />make: Jaguar","hwy: 21<br />cty: 15<br />make: Jeep","hwy: 18<br />cty: 14<br />make: Jeep","hwy: 18<br />cty: 13<br />make: Jeep","hwy: 19<br />cty: 15<br />make: Jeep","hwy: 18<br />cty: 13<br />make: Jeep","hwy: 19<br />cty: 14<br />make: Jeep","hwy: 24<br />cty: 18<br />make: Jeep","hwy: 20<br />cty: 15<br />make: Jeep","hwy: 20<br />cty: 16<br />make: Jeep","hwy: 22<br />cty: 18<br />make: Jeep","hwy: 20<br />cty: 15<br />make: Jeep","hwy: 20<br />cty: 16<br />make: Jeep","hwy: 24<br />cty: 19<br />make: Jeep","hwy: 19<br />cty: 16<br />make: Jeep","hwy: 16<br />cty: 13<br />make: Jeep","hwy: 17<br />cty: 13<br />make: Jeep","hwy: 23<br />cty: 15<br />make: Kia","hwy: 28<br />cty: 19<br />make: Kia","hwy: 27<br />cty: 20<br />make: Kia","hwy: 25<br />cty: 18<br />make: Kia","hwy: 26<br />cty: 18<br />make: Kia","hwy: 29<br />cty: 21<br />make: Kia","hwy: 29<br />cty: 22<br />make: Kia","hwy: 21<br />cty: 14<br />make: Kia","hwy: 20<br />cty: 14<br />make: Kia","hwy: 19<br />cty: 15<br />make: Kia","hwy: 18<br />cty: 13<br />make: Kia","hwy: 18<br />cty: 14<br />make: Kia","hwy: 31<br />cty: 21<br />make: Kia","hwy: 30<br />cty: 22<br />make: Kia","hwy: 25<br />cty: 19<br />make: Kia","hwy: 25<br />cty: 20<br />make: Kia","hwy: 23<br />cty: 17<br />make: Kia","hwy: 24<br />cty: 19<br />make: Kia","hwy: 21<br />cty: 17<br />make: Kia","hwy: 14<br />cty:  8<br />make: Lamborghini","hwy: 16<br />cty:  9<br />make: Lamborghini","hwy: 12<br />cty:  8<br />make: Lamborghini","hwy: 14<br />cty:  9<br />make: Lamborghini","hwy: 19<br />cty: 16<br />make: Land Rover","hwy: 18<br />cty: 13<br />make: Land Rover","hwy: 17<br />cty: 13<br />make: Land Rover","hwy: 15<br />cty: 11<br />make: Land Rover","hwy: 27<br />cty: 18<br />make: Lexus","hwy: 23<br />cty: 16<br />make: Lexus","hwy: 22<br />cty: 16<br />make: Lexus","hwy: 18<br />cty: 14<br />make: Lexus","hwy: 23<br />cty: 16<br />make: Lexus","hwy: 23<br />cty: 16<br />make: Lexus","hwy: 23<br />cty: 16<br />make: Lexus","hwy: 16<br />cty: 12<br />make: Lexus","hwy: 23<br />cty: 17<br />make: Lexus","hwy: 23<br />cty: 17<br />make: Lexus","hwy: 22<br />cty: 16<br />make: Lexus","hwy: 22<br />cty: 16<br />make: Lexus","hwy: 22<br />cty: 16<br />make: Lexus","hwy: 17<br />cty: 11<br />make: Lincoln","hwy: 16<br />cty: 11<br />make: Lincoln","hwy: 24<br />cty: 17<br />make: Lincoln","hwy: 24<br />cty: 17<br />make: Lincoln","hwy: 22<br />cty: 16<br />make: Lincoln","hwy: 22<br />cty: 16<br />make: Lincoln","hwy: 17<br />cty: 11<br />make: Lincoln","hwy: 23<br />cty: 16<br />make: Lincoln","hwy: 25<br />cty: 20<br />make: Lotus","hwy: 15<br />cty: 10<br />make: Maserati","hwy: 16<br />cty: 11<br />make: Maserati","hwy: 14<br />cty: 11<br />make: Maserati","hwy: 15<br />cty: 10<br />make: Maserati","hwy: 16<br />cty: 11<br />make: Maserati","hwy: 16<br />cty: 11<br />make: Maybach","hwy: 16<br />cty: 11<br />make: Maybach","hwy: 32<br />cty: 24<br />make: Mazda","hwy: 31<br />cty: 23<br />make: Mazda","hwy: 29<br />cty: 22<br />make: Mazda","hwy: 26<br />cty: 21<br />make: Mazda","hwy: 28<br />cty: 21<br />make: Mazda","hwy: 26<br />cty: 20<br />make: Mazda","hwy: 24<br />cty: 17<br />make: Mazda","hwy: 25<br />cty: 17<br />make: Mazda","hwy: 24<br />cty: 17<br />make: Mazda","hwy: 25<br />cty: 17<br />make: Mazda","hwy: 24<br />cty: 19<br />make: Mazda","hwy: 27<br />cty: 21<br />make: Mazda","hwy: 21<br />cty: 16<br />make: Mazda","hwy: 21<br />cty: 16<br />make: Mazda","hwy: 21<br />cty: 15<br />make: Mazda","hwy: 21<br />cty: 16<br />make: Mazda","hwy: 18<br />cty: 14<br />make: Mazda","hwy: 17<br />cty: 14<br />make: Mazda","hwy: 23<br />cty: 16<br />make: Mazda","hwy: 26<br />cty: 20<br />make: Mazda","hwy: 26<br />cty: 20<br />make: Mazda","hwy: 26<br />cty: 20<br />make: Mazda","hwy: 24<br />cty: 18<br />make: Mazda","hwy: 22<br />cty: 16<br />make: Mazda","hwy: 22<br />cty: 16<br />make: Mazda","hwy: 23<br />cty: 19<br />make: Mazda","hwy: 27<br />cty: 21<br />make: Mazda","hwy: 23<br />cty: 17<br />make: Mazda","hwy: 20<br />cty: 17<br />make: Mazda","hwy: 24<br />cty: 19<br />make: Mazda","hwy: 20<br />cty: 16<br />make: Mazda","hwy: 29<br />cty: 21<br />make: Mercedes-Benz","hwy: 29<br />cty: 20<br />make: Mercedes-Benz","hwy: 29<br />cty: 21<br />make: Mercedes-Benz","hwy: 28<br />cty: 21<br />make: Mercedes-Benz","hwy: 23<br />cty: 17<br />make: Mercedes-Benz","hwy: 22<br />cty: 17<br />make: Mercedes-Benz","hwy: 23<br />cty: 17<br />make: Mercedes-Benz","hwy: 23<br />cty: 17<br />make: Mercedes-Benz","hwy: 24<br />cty: 17<br />make: Mercedes-Benz","hwy: 24<br />cty: 17<br />make: Mercedes-Benz","hwy: 24<br />cty: 18<br />make: Mercedes-Benz","hwy: 22<br />cty: 16<br />make: Mercedes-Benz","hwy: 22<br />cty: 17<br />make: Mercedes-Benz","hwy: 20<br />cty: 14<br />make: Mercedes-Benz","hwy: 22<br />cty: 14<br />make: Mercedes-Benz","hwy: 20<br />cty: 13<br />make: Mercedes-Benz","hwy: 17<br />cty: 12<br />make: Mercedes-Benz","hwy: 18<br />cty: 11<br />make: Mercedes-Benz","hwy: 26<br />cty: 18<br />make: Mercedes-Benz","hwy: 24<br />cty: 18<br />make: Mercedes-Benz","hwy: 23<br />cty: 15<br />make: Mercedes-Benz","hwy: 23<br />cty: 15<br />make: Mercedes-Benz","hwy: 21<br />cty: 14<br />make: Mercedes-Benz","hwy: 21<br />cty: 14<br />make: Mercedes-Benz","hwy: 26<br />cty: 18<br />make: Mercedes-Benz","hwy: 25<br />cty: 17<br />make: Mercedes-Benz","hwy: 23<br />cty: 17<br />make: Mercedes-Benz","hwy: 22<br />cty: 16<br />make: Mercedes-Benz","hwy: 33<br />cty: 23<br />make: Mercedes-Benz","hwy: 23<br />cty: 15<br />make: Mercedes-Benz","hwy: 19<br />cty: 14<br />make: Mercedes-Benz","hwy: 18<br />cty: 14<br />make: Mercedes-Benz","hwy: 19<br />cty: 13<br />make: Mercedes-Benz","hwy: 19<br />cty: 13<br />make: Mercedes-Benz","hwy: 13<br />cty: 11<br />make: Mercedes-Benz","hwy: 13<br />cty: 11<br />make: Mercedes-Benz","hwy: 17<br />cty: 14<br />make: Mercedes-Benz","hwy: 16<br />cty: 13<br />make: Mercedes-Benz","hwy: 24<br />cty: 16<br />make: Mercedes-Benz","hwy: 21<br />cty: 15<br />make: Mercedes-Benz","hwy: 22<br />cty: 14<br />make: Mercedes-Benz","hwy: 20<br />cty: 14<br />make: Mercedes-Benz","hwy: 20<br />cty: 13<br />make: Mercedes-Benz","hwy: 17<br />cty: 11<br />make: Mercedes-Benz","hwy: 21<br />cty: 14<br />make: Mercedes-Benz","hwy: 18<br />cty: 12<br />make: Mercedes-Benz","hwy: 18<br />cty: 11<br />make: Mercedes-Benz","hwy: 18<br />cty: 11<br />make: Mercedes-Benz","hwy: 23<br />cty: 17<br />make: Mercedes-Benz","hwy: 23<br />cty: 16<br />make: Mercedes-Benz","hwy: 20<br />cty: 14<br />make: Mercedes-Benz","hwy: 16<br />cty: 12<br />make: Mercedes-Benz","hwy: 23<br />cty: 16<br />make: Mercury","hwy: 24<br />cty: 19<br />make: Mercury","hwy: 23<br />cty: 17<br />make: Mercury","hwy: 21<br />cty: 17<br />make: Mercury","hwy: 21<br />cty: 16<br />make: Mercury","hwy: 23<br />cty: 17<br />make: Mercury","hwy: 25<br />cty: 18<br />make: Mercury","hwy: 26<br />cty: 19<br />make: Mercury","hwy: 21<br />cty: 16<br />make: Mercury","hwy: 19<br />cty: 14<br />make: Mercury","hwy: 18<br />cty: 13<br />make: Mercury","hwy: 19<br />cty: 13<br />make: Mercury","hwy: 17<br />cty: 13<br />make: Mercury","hwy: 17<br />cty: 13<br />make: Mercury","hwy: 19<br />cty: 13<br />make: Mercury","hwy: 17<br />cty: 13<br />make: Mercury","hwy: 25<br />cty: 18<br />make: Mercury","hwy: 25<br />cty: 18<br />make: Mercury","hwy: 25<br />cty: 17<br />make: Mercury","hwy: 23<br />cty: 17<br />make: Mercury","hwy: 24<br />cty: 17<br />make: Mercury","hwy: 24<br />cty: 17<br />make: Mercury","hwy: 31<br />cty: 23<br />make: MINI","hwy: 33<br />cty: 24<br />make: MINI","hwy: 30<br />cty: 23<br />make: MINI","hwy: 32<br />cty: 24<br />make: MINI","hwy: 29<br />cty: 22<br />make: MINI","hwy: 29<br />cty: 21<br />make: MINI","hwy: 29<br />cty: 22<br />make: MINI","hwy: 29<br />cty: 21<br />make: MINI","hwy: 23<br />cty: 15<br />make: Mitsubishi","hwy: 25<br />cty: 19<br />make: Mitsubishi","hwy: 28<br />cty: 20<br />make: Mitsubishi","hwy: 25<br />cty: 19<br />make: Mitsubishi","hwy: 27<br />cty: 18<br />make: Mitsubishi","hwy: 26<br />cty: 18<br />make: Mitsubishi","hwy: 25<br />cty: 18<br />make: Mitsubishi","hwy: 25<br />cty: 18<br />make: Mitsubishi","hwy: 28<br />cty: 20<br />make: Mitsubishi","hwy: 24<br />cty: 18<br />make: Mitsubishi","hwy: 26<br />cty: 18<br />make: Mitsubishi","hwy: 26<br />cty: 18<br />make: Mitsubishi","hwy: 25<br />cty: 18<br />make: Mitsubishi","hwy: 25<br />cty: 18<br />make: Mitsubishi","hwy: 21<br />cty: 16<br />make: Mitsubishi","hwy: 20<br />cty: 15<br />make: Mitsubishi","hwy: 27<br />cty: 20<br />make: Mitsubishi","hwy: 25<br />cty: 17<br />make: Mitsubishi","hwy: 28<br />cty: 22<br />make: Mitsubishi","hwy: 31<br />cty: 24<br />make: Mitsubishi","hwy: 26<br />cty: 20<br />make: Mitsubishi","hwy: 27<br />cty: 20<br />make: Mitsubishi","hwy: 24<br />cty: 17<br />make: Mitsubishi","hwy: 23<br />cty: 17<br />make: Mitsubishi","hwy: 26<br />cty: 20<br />make: Mitsubishi","hwy: 17<br />cty: 13<br />make: Mitsubishi","hwy: 25<br />cty: 19<br />make: Mitsubishi","hwy: 24<br />cty: 19<br />make: Mitsubishi","hwy: 25<br />cty: 18<br />make: Mitsubishi","hwy: 23<br />cty: 18<br />make: Mitsubishi","hwy: 24<br />cty: 17<br />make: Nissan","hwy: 23<br />cty: 17<br />make: Nissan","hwy: 23<br />cty: 17<br />make: Nissan","hwy: 24<br />cty: 17<br />make: Nissan","hwy: 23<br />cty: 16<br />make: Nissan","hwy: 27<br />cty: 21<br />make: Nissan","hwy: 29<br />cty: 21<br />make: Nissan","hwy: 25<br />cty: 19<br />make: Nissan","hwy: 26<br />cty: 18<br />make: Nissan","hwy: 28<br />cty: 18<br />make: Nissan","hwy: 18<br />cty: 12<br />make: Nissan","hwy: 17<br />cty: 12<br />make: Nissan","hwy: 22<br />cty: 17<br />make: Nissan","hwy: 23<br />cty: 19<br />make: Nissan","hwy: 19<br />cty: 14<br />make: Nissan","hwy: 20<br />cty: 15<br />make: Nissan","hwy: 19<br />cty: 14<br />make: Nissan","hwy: 19<br />cty: 15<br />make: Nissan","hwy: 27<br />cty: 18<br />make: Nissan","hwy: 26<br />cty: 18<br />make: Nissan","hwy: 23<br />cty: 18<br />make: Nissan","hwy: 23<br />cty: 18<br />make: Nissan","hwy: 21<br />cty: 14<br />make: Nissan","hwy: 19<br />cty: 14<br />make: Nissan","hwy: 24<br />cty: 17<br />make: Nissan","hwy: 23<br />cty: 16<br />make: Nissan","hwy: 31<br />cty: 24<br />make: Nissan","hwy: 32<br />cty: 24<br />make: Nissan","hwy: 26<br />cty: 20<br />make: Nissan","hwy: 27<br />cty: 20<br />make: Nissan","hwy: 17<br />cty: 13<br />make: Nissan","hwy: 17<br />cty: 13<br />make: Nissan","hwy: 17<br />cty: 12<br />make: Nissan","hwy: 17<br />cty: 12<br />make: Nissan","hwy: 20<br />cty: 14<br />make: Nissan","hwy: 21<br />cty: 15<br />make: Nissan","hwy: 19<br />cty: 14<br />make: Nissan","hwy: 19<br />cty: 15<br />make: Nissan","hwy: 22<br />cty: 16<br />make: Pontiac","hwy: 24<br />cty: 17<br />make: Pontiac","hwy: 27<br />cty: 18<br />make: Pontiac","hwy: 22<br />cty: 15<br />make: Pontiac","hwy: 29<br />cty: 20<br />make: Pontiac","hwy: 26<br />cty: 19<br />make: Pontiac","hwy: 31<br />cty: 22<br />make: Pontiac","hwy: 27<br />cty: 18<br />make: Pontiac","hwy: 26<br />cty: 17<br />make: Pontiac","hwy: 27<br />cty: 18<br />make: Pontiac","hwy: 24<br />cty: 16<br />make: Pontiac","hwy: 25<br />cty: 16<br />make: Pontiac","hwy: 23<br />cty: 15<br />make: Pontiac","hwy: 19<br />cty: 14<br />make: Pontiac","hwy: 21<br />cty: 15<br />make: Pontiac","hwy: 23<br />cty: 16<br />make: Pontiac","hwy: 24<br />cty: 17<br />make: Pontiac","hwy: 31<br />cty: 21<br />make: Pontiac","hwy: 32<br />cty: 23<br />make: Pontiac","hwy: 31<br />cty: 25<br />make: Pontiac","hwy: 29<br />cty: 22<br />make: Pontiac","hwy: 33<br />cty: 26<br />make: Pontiac","hwy: 29<br />cty: 22<br />make: Pontiac","hwy: 31<br />cty: 23<br />make: Pontiac","hwy: 32<br />cty: 23<br />make: Pontiac","hwy: 31<br />cty: 23<br />make: Pontiac","hwy: 32<br />cty: 23<br />make: Pontiac","hwy: 27<br />cty: 18<br />make: Porsche","hwy: 26<br />cty: 18<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 25<br />cty: 17<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 21<br />cty: 14<br />make: Porsche","hwy: 24<br />cty: 17<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 17<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 17<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 17<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 21<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 21<br />cty: 15<br />make: Porsche","hwy: 22<br />cty: 15<br />make: Porsche","hwy: 15<br />cty:  9<br />make: Porsche","hwy: 18<br />cty: 14<br />make: Porsche","hwy: 19<br />cty: 13<br />make: Porsche","hwy: 17<br />cty: 12<br />make: Porsche","hwy: 17<br />cty: 12<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 24<br />cty: 16<br />make: Porsche","hwy: 22<br />cty: 14<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 21<br />cty: 14<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 21<br />cty: 14<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 20<br />cty: 13<br />make: Porsche","hwy: 21<br />cty: 14<br />make: Porsche","hwy: 17<br />cty: 11<br />make: Rolls-Royce","hwy: 23<br />cty: 17<br />make: Saab","hwy: 24<br />cty: 17<br />make: Saab","hwy: 26<br />cty: 20<br />make: Saab","hwy: 27<br />cty: 20<br />make: Saab","hwy: 26<br />cty: 19<br />make: Saab","hwy: 25<br />cty: 17<br />make: Saab","hwy: 29<br />cty: 19<br />make: Saab","hwy: 28<br />cty: 19<br />make: Saab","hwy: 26<br />cty: 19<br />make: Saab","hwy: 28<br />cty: 19<br />make: Saab","hwy: 28<br />cty: 18<br />make: Saab","hwy: 26<br />cty: 17<br />make: Saab","hwy: 28<br />cty: 18<br />make: Saab","hwy: 26<br />cty: 17<br />make: Saab","hwy: 19<br />cty: 14<br />make: Saab","hwy: 17<br />cty: 14<br />make: Saab","hwy: 27<br />cty: 20<br />make: Saturn","hwy: 29<br />cty: 21<br />make: Saturn","hwy: 32<br />cty: 23<br />make: Saturn","hwy: 26<br />cty: 18<br />make: Saturn","hwy: 26<br />cty: 18<br />make: Saturn","hwy: 21<br />cty: 15<br />make: Saturn","hwy: 23<br />cty: 16<br />make: Saturn","hwy: 24<br />cty: 19<br />make: Saturn","hwy: 23<br />cty: 17<br />make: Saturn","hwy: 26<br />cty: 20<br />make: Saturn","hwy: 25<br />cty: 19<br />make: Saturn","hwy: 27<br />cty: 20<br />make: Saturn","hwy: 25<br />cty: 18<br />make: Saturn","hwy: 27<br />cty: 20<br />make: Scion","hwy: 27<br />cty: 19<br />make: Scion","hwy: 35<br />cty: 27<br />make: Scion","hwy: 34<br />cty: 27<br />make: Scion","hwy: 32<br />cty: 27<br />make: Scion","hwy: 31<br />cty: 27<br />make: Scion","hwy: 18<br />cty: 13<br />make: Spyker","hwy: 18<br />cty: 13<br />make: Spyker","hwy: 18<br />cty: 13<br />make: Spyker","hwy: 25<br />cty: 19<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 25<br />cty: 19<br />make: Subaru","hwy: 21<br />cty: 16<br />make: Subaru","hwy: 22<br />cty: 18<br />make: Subaru","hwy: 26<br />cty: 20<br />make: Subaru","hwy: 22<br />cty: 17<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 24<br />cty: 17<br />make: Subaru","hwy: 25<br />cty: 18<br />make: Subaru","hwy: 26<br />cty: 20<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 22<br />cty: 16<br />make: Subaru","hwy: 24<br />cty: 17<br />make: Subaru","hwy: 25<br />cty: 18<br />make: Subaru","hwy: 26<br />cty: 20<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 27<br />cty: 20<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 26<br />cty: 20<br />make: Subaru","hwy: 26<br />cty: 20<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 23<br />cty: 17<br />make: Subaru","hwy: 28<br />cty: 22<br />make: Suzuki","hwy: 28<br />cty: 22<br />make: Suzuki","hwy: 26<br />cty: 21<br />make: Suzuki","hwy: 28<br />cty: 22<br />make: Suzuki","hwy: 28<br />cty: 22<br />make: Suzuki","hwy: 26<br />cty: 21<br />make: Suzuki","hwy: 28<br />cty: 20<br />make: Suzuki","hwy: 27<br />cty: 20<br />make: Suzuki","hwy: 26<br />cty: 18<br />make: Suzuki","hwy: 27<br />cty: 18<br />make: Suzuki","hwy: 20<br />cty: 17<br />make: Suzuki","hwy: 21<br />cty: 17<br />make: Suzuki","hwy: 20<br />cty: 17<br />make: Suzuki","hwy: 20<br />cty: 17<br />make: Suzuki","hwy: 21<br />cty: 16<br />make: Suzuki","hwy: 20<br />cty: 15<br />make: Suzuki","hwy: 20<br />cty: 15<br />make: Suzuki","hwy: 20<br />cty: 15<br />make: Suzuki","hwy: 28<br />cty: 20<br />make: Suzuki","hwy: 27<br />cty: 20<br />make: Suzuki","hwy: 31<br />cty: 23<br />make: Suzuki","hwy: 32<br />cty: 23<br />make: Suzuki","hwy: 31<br />cty: 23<br />make: Suzuki","hwy: 32<br />cty: 23<br />make: Suzuki","hwy: 25<br />cty: 18<br />make: Suzuki","hwy: 20<br />cty: 16<br />make: Toyota","hwy: 18<br />cty: 15<br />make: Toyota","hwy: 19<br />cty: 15<br />make: Toyota","hwy: 18<br />cty: 14<br />make: Toyota","hwy: 28<br />cty: 19<br />make: Toyota","hwy: 31<br />cty: 21<br />make: Toyota","hwy: 30<br />cty: 21<br />make: Toyota","hwy: 26<br />cty: 18<br />make: Toyota","hwy: 27<br />cty: 18<br />make: Toyota","hwy: 29<br />cty: 20<br />make: Toyota","hwy: 30<br />cty: 21<br />make: Toyota","hwy: 27<br />cty: 18<br />make: Toyota","hwy: 26<br />cty: 18<br />make: Toyota","hwy: 33<br />cty: 25<br />make: Toyota","hwy: 30<br />cty: 23<br />make: Toyota","hwy: 30<br />cty: 21<br />make: Toyota","hwy: 28<br />cty: 22<br />make: Toyota","hwy: 35<br />cty: 26<br />make: Toyota","hwy: 37<br />cty: 28<br />make: Toyota","hwy: 31<br />cty: 22<br />make: Toyota","hwy: 36<br />cty: 28<br />make: Toyota","hwy: 38<br />cty: 30<br />make: Toyota","hwy: 25<br />cty: 19<br />make: Toyota","hwy: 23<br />cty: 17<br />make: Toyota","hwy: 23<br />cty: 19<br />make: Toyota","hwy: 22<br />cty: 16<br />make: Toyota","hwy: 16<br />cty: 12<br />make: Toyota","hwy: 31<br />cty: 25<br />make: Toyota","hwy: 29<br />cty: 22<br />make: Toyota","hwy: 33<br />cty: 26<br />make: Toyota","hwy: 29<br />cty: 22<br />make: Toyota","hwy: 29<br />cty: 23<br />make: Toyota","hwy: 30<br />cty: 23<br />make: Toyota","hwy: 45<br />cty: 48<br />make: Toyota","hwy: 27<br />cty: 21<br />make: Toyota","hwy: 27<br />cty: 21<br />make: Toyota","hwy: 24<br />cty: 20<br />make: Toyota","hwy: 25<br />cty: 19<br />make: Toyota","hwy: 17<br />cty: 14<br />make: Toyota","hwy: 16<br />cty: 13<br />make: Toyota","hwy: 24<br />cty: 17<br />make: Toyota","hwy: 22<br />cty: 16<br />make: Toyota","hwy: 24<br />cty: 18<br />make: Toyota","hwy: 25<br />cty: 18<br />make: Toyota","hwy: 21<br />cty: 16<br />make: Toyota","hwy: 19<br />cty: 14<br />make: Toyota","hwy: 21<br />cty: 17<br />make: Toyota","hwy: 20<br />cty: 16<br />make: Toyota","hwy: 18<br />cty: 14<br />make: Toyota","hwy: 20<br />cty: 16<br />make: Toyota","hwy: 19<br />cty: 14<br />make: Toyota","hwy: 17<br />cty: 14<br />make: Toyota","hwy: 17<br />cty: 13<br />make: Toyota","hwy: 41<br />cty: 32<br />make: Volkswagen","hwy: 39<br />cty: 28<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 29<br />cty: 21<br />make: Volkswagen","hwy: 27<br />cty: 19<br />make: Volkswagen","hwy: 27<br />cty: 19<br />make: Volkswagen","hwy: 29<br />cty: 21<br />make: Volkswagen","hwy: 27<br />cty: 19<br />make: Volkswagen","hwy: 27<br />cty: 19<br />make: Volkswagen","hwy: 41<br />cty: 32<br />make: Volkswagen","hwy: 39<br />cty: 28<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 39<br />cty: 31<br />make: Volkswagen","hwy: 38<br />cty: 30<br />make: Volkswagen","hwy: 29<br />cty: 21<br />make: Volkswagen","hwy: 27<br />cty: 19<br />make: Volkswagen","hwy: 39<br />cty: 31<br />make: Volkswagen","hwy: 39<br />cty: 28<br />make: Volkswagen","hwy: 27<br />cty: 20<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 28<br />cty: 22<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 41<br />cty: 32<br />make: Volkswagen","hwy: 38<br />cty: 30<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 28<br />cty: 22<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 28<br />cty: 21<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 34<br />cty: 23<br />make: Volkswagen","hwy: 26<br />cty: 17<br />make: Volkswagen","hwy: 25<br />cty: 17<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 26<br />cty: 18<br />make: Volkswagen","hwy: 24<br />cty: 17<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 34<br />cty: 23<br />make: Volkswagen","hwy: 26<br />cty: 17<br />make: Volkswagen","hwy: 25<br />cty: 17<br />make: Volkswagen","hwy: 28<br />cty: 19<br />make: Volkswagen","hwy: 26<br />cty: 18<br />make: Volkswagen","hwy: 24<br />cty: 17<br />make: Volkswagen","hwy: 21<br />cty: 14<br />make: Volkswagen","hwy: 17<br />cty: 11<br />make: Volkswagen","hwy: 19<br />cty: 14<br />make: Volkswagen","hwy: 17<br />cty: 12<br />make: Volkswagen","hwy: 25<br />cty: 17<br />make: Volvo","hwy: 25<br />cty: 18<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 29<br />cty: 19<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 24<br />cty: 17<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 26<br />cty: 18<br />make: Volvo","hwy: 26<br />cty: 18<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 23<br />cty: 16<br />make: Volvo","hwy: 22<br />cty: 16<br />make: Volvo","hwy: 24<br />cty: 17<br />make: Volvo","hwy: 27<br />cty: 18<br />make: Volvo","hwy: 24<br />cty: 16<br />make: Volvo","hwy: 25<br />cty: 17<br />make: Volvo","hwy: 24<br />cty: 17<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 29<br />cty: 19<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 24<br />cty: 17<br />make: Volvo","hwy: 26<br />cty: 18<br />make: Volvo","hwy: 27<br />cty: 19<br />make: Volvo","hwy: 24<br />cty: 17<br />make: Volvo","hwy: 24<br />cty: 17<br />make: Volvo","hwy: 27<br />cty: 18<br />make: Volvo","hwy: 23<br />cty: 16<br />make: Volvo","hwy: 22<br />cty: 16<br />make: Volvo","hwy: 22<br />cty: 16<br />make: Volvo","hwy: 20<br />cty: 15<br />make: Volvo","hwy: 19<br />cty: 14<br />make: Volvo","hwy: 19<br />cty: 13<br />make: Volvo","hwy: 21<br />cty: 16<br />make: Volvo"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":41.511000415110011,"l":41.511000415110011},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[8.6500000000000004,60.350000000000001],"tickmode":"array","ticktext":["10","20","30","40","50","60"],"tickvals":[10,20,30,40.000000000000007,50,60],"categoryorder":"array","categoryarray":["10","20","30","40","50","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.611872146118724},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"hwy","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[6,50],"tickmode":"array","ticktext":["10","20","30","40","50"],"tickvals":[10,20,30,40,50],"categoryorder":"array","categoryarray":["10","20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.611872146118724},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"cty","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"93f33bd5580a":{"x":{},"y":{},"label":{},"type":"scatter"}},"cur_data":"93f33bd5580a","visdat":{"93f33bd5580a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Note that <code>plotly</code> can also be used to directly generate advanced interactive plots, without the intermediate <code>ggplot</code> object.</p>
</section>
<section id="ggiraph" class="level2">
<h2 class="anchored" data-anchor-id="ggiraph">ggiraph</h2>
<p>Another option for making interactive graphs is to use the <code>ggiraph</code> package, which provides dedicated interactive layers.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">girafe</span>(<span class="at">ggobj =</span> <span class="fu">ggplot</span>(vehicles) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_point_interactive</span>(<span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tooltip =</span> make, <span class="at">data_id =</span> make)) <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>           ggp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="titles-subtitles-and-captions" class="level1">
<h1>Titles, subtitles and captions</h1>
<p><code>ggplot2</code> provides many ways of labeling your plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"This is the title"</span>, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"And a subtitle"</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"And the caption goes here"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Highway fuel economy (mpg)"</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"City fuel economy (mpg)"</span>) <span class="sc">+</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that not all of these are compatible with interactive plots (<code>subtitle</code> and <code>caption</code>):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"This is the title"</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="st">"And a subtitle"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"And the caption goes here"</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">"Highway fuel economy (mpg)"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">"City fuel economy (mpg)"</span>) <span class="sc">+</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        ggp</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8366fb474d731324b7d3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8366fb474d731324b7d3">{"x":{"data":[{"x":[21,22,22,24,31,28,31,26,26,27,28,18,16,17,16,16,27,29,26,30,31,28,26,24,24,28,27,24,28,26,24,27,26,24,24,28,27,24,24,22,22,19,21,20,19,20,21,20,21,20,20,27,26,24,26,26,23,13,13,16,27,25,25,24,27,25,28,27,25,25,24,24,24,27,25,27,26,23,25,27,25,27,27,23,26,26,27,27,26,23,24,22,23,24,22,21,24,21,24,24,21,21,22,21,21,20,22,22,23,21,20,19,20,20,26,26,27,25,27,27,25,27,27,26,27,20,19,19,17,22,23,24,24,21,23,18,25,25,24,24,21,22,24,19,17,16,16,16,18,20,22,19,21,19,23,23,21,23,20,19,20,18,16,16,18,17,31,32,31,32,20,20,18,17,31,33,31,27,29,31,23,24,22,23,21,22,21,22,23,24,22,21,22,21,24,26,25,23,23,17,18,17,29,26,27,27,32,29,28,29,26,28,28,27,28,27,26,27,19,18,19,20,19,19,19,18,19,17,18,18,18,17,17,15,12,11,11,18,19,18,18,17,17,19,19,18,19,18,17,18,17,20,19,18,19,17,18,21,23,17,17,17,19,19,17,24,22,22,26,25,23,18,25,22,23,25,22,23,21,23,20,24,24,25,26,24,24,25,26,26,29,25,27,25,27,25,25,27,25,25,24,23,23,24,24,23,23,20,20,18,19,18,19,19,18,19,17,17,17,17,26,25,23,22,22,29,32,28,19,20,17,17,11,14,14,17,17,16,14,16,26,29,25,27,25,27,25,25,19,15,15,15,16,15,16,15,16,23,20,17,15,18,16,17,23,27,23,20,24,20,28,26,18,17,19,18,19,18,17,18,19,18,18,19,18,17,16,17,23,25,26,29,32,28,29,32,22,21,22,21,22,25,19,23,26,22,23,24,27,21,21,21,21,19,19,18,17,25,25,25,23,24,24,22,22,23,24,22,23,21,22,21,22,23,24,22,21,22,21,20,19,19,17,18,19,17,18,18,19,17,18,20,20,19,18,16,16,17,17,17,17,18,19,18,17,17,19,18,20,20,19,19,19,18,19,17,18,18,18,17,17,15,12,11,11,19,19,18,19,18,17,18,16,17,18,17,16,17,31,31,28,27,33,36,34,35,34,39,34,28,31,43,42,45,45,26,25,24,24,23,23,22,49,58,26,23,20,23,32,33,32,30,29,31,24,25,23,22,21,21,27,28,25,25,27,28,24,24,24,25,25,24,24,23,24,20,22,18,24,23,22,23,22,18,17,20,19,18,19,19,18,24,24,25,22,22,25,24,25,23,25,24,25,23,25,25,25,22,24,24,21,21,21,18,18,19,18,19,24,20,20,22,20,20,24,19,16,17,23,28,27,25,26,29,29,21,20,19,18,18,31,30,25,25,23,24,21,14,16,12,14,19,18,17,15,27,23,22,18,23,23,23,16,23,23,22,22,22,17,16,24,24,22,22,17,23,25,15,16,14,15,16,16,16,32,31,29,26,28,26,24,25,24,25,24,27,21,21,21,21,18,17,23,26,26,26,24,22,22,23,27,23,20,24,20,29,29,29,28,23,22,23,23,24,24,24,22,22,20,22,20,17,18,26,24,23,23,21,21,26,25,23,22,33,23,19,18,19,19,13,13,17,16,24,21,22,20,20,17,21,18,18,18,23,23,20,16,23,24,23,21,21,23,25,26,21,19,18,19,17,17,19,17,25,25,25,23,24,24,31,33,30,32,29,29,29,29,23,25,28,25,27,26,25,25,28,24,26,26,25,25,21,20,27,25,28,31,26,27,24,23,26,17,25,24,25,23,24,23,23,24,23,27,29,25,26,28,18,17,22,23,19,20,19,19,27,26,23,23,21,19,24,23,31,32,26,27,17,17,17,17,20,21,19,19,22,24,27,22,29,26,31,27,26,27,24,25,23,19,21,23,24,31,32,31,29,33,29,31,32,31,32,27,26,24,25,24,21,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,22,22,22,22,22,22,22,22,21,22,21,22,15,18,19,17,17,24,24,24,24,22,20,21,20,21,20,20,20,20,20,20,20,21,17,23,24,26,27,26,25,29,28,26,28,28,26,28,26,19,17,27,29,32,26,26,21,23,24,23,26,25,27,25,27,27,35,34,32,31,18,18,18,25,23,25,21,22,26,22,27,24,25,26,27,22,24,25,26,27,23,27,27,23,23,27,27,23,23,23,26,26,23,23,28,28,26,28,28,26,28,27,26,27,20,21,20,20,21,20,20,20,28,27,31,32,31,32,25,20,18,19,18,28,31,30,26,27,29,30,27,26,33,30,30,28,35,37,31,36,38,25,23,23,22,16,31,29,33,29,29,30,45,27,27,24,25,17,16,24,22,24,25,21,19,21,20,18,20,19,17,17,41,39,28,28,29,27,27,29,27,27,41,39,28,28,28,28,39,38,29,27,39,39,27,28,28,28,41,38,28,28,28,28,28,28,28,28,34,26,25,28,26,24,28,28,34,26,25,28,26,24,21,17,19,17,25,25,27,27,29,27,24,27,27,26,26,27,23,22,24,27,24,25,24,27,27,29,27,24,26,27,24,24,27,23,22,22,20,19,19,21],"y":[15,16,16,16,24,20,22,18,18,19,20,11,10,11,10,10,20,20,19,21,20,19,18,16,16,20,19,17,20,18,16,19,18,16,16,20,19,17,17,16,16,13,14,15,14,13,14,13,14,13,14,18,18,17,18,18,17,9,9,10,18,17,17,16,18,17,19,18,17,17,17,17,17,18,17,18,17,16,17,18,17,18,18,16,17,17,18,18,17,15,16,15,15,16,15,13,16,13,16,16,13,13,15,15,14,14,15,15,15,14,13,14,14,14,18,18,18,17,18,18,17,18,18,17,18,14,14,14,14,16,16,17,16,15,16,13,16,16,15,16,13,15,16,14,13,12,12,12,13,13,15,14,14,14,16,15,14,15,15,14,14,14,12,12,13,13,23,23,23,23,15,14,14,13,21,23,22,20,21,22,16,18,16,17,15,17,16,17,16,18,16,15,17,16,16,16,18,17,17,13,13,13,19,17,18,17,21,20,20,19,17,18,20,20,20,20,18,18,16,15,14,14,15,14,14,13,14,13,13,14,14,13,13,12,10,8,8,14,12,14,13,13,13,14,14,14,14,13,13,13,13,14,14,13,13,12,13,15,16,13,13,13,14,14,13,17,15,15,18,17,15,13,19,15,15,19,15,15,15,16,15,17,19,19,19,17,19,19,19,19,21,18,18,18,20,19,19,20,19,19,17,16,16,17,17,16,16,15,14,14,13,14,15,14,13,14,13,12,12,12,18,17,15,15,15,22,25,19,14,14,13,12,8,9,11,13,12,12,11,12,19,21,18,18,18,20,19,19,11,10,10,9,9,10,9,10,10,16,14,13,12,13,13,13,19,21,17,17,19,16,30,28,13,13,14,13,13,13,13,13,13,13,14,13,13,13,12,13,17,18,19,22,22,20,22,22,16,16,16,16,17,18,12,17,17,16,15,19,21,16,16,15,16,15,15,14,14,18,18,17,17,17,17,16,16,16,18,16,17,15,17,16,17,16,18,16,15,17,16,14,14,14,14,13,13,12,13,13,14,12,13,15,14,14,14,12,12,13,13,13,13,14,14,13,13,13,16,15,14,14,15,14,14,13,14,13,13,14,14,13,13,12,10,8,8,14,14,14,14,13,13,13,12,13,13,13,12,13,21,23,19,18,25,29,25,26,27,31,27,22,26,39,39,37,38,20,20,19,19,19,19,18,45,48,17,17,15,17,23,24,23,25,21,23,18,18,17,16,16,15,19,20,17,18,19,21,17,17,16,19,20,18,19,17,16,15,15,14,17,16,16,16,16,12,12,14,14,13,13,14,13,16,16,16,15,15,16,16,17,16,16,17,17,16,16,16,16,15,16,16,14,14,15,14,13,15,13,14,18,15,16,18,15,16,19,16,13,13,15,19,20,18,18,21,22,14,14,15,13,14,21,22,19,20,17,19,17,8,9,8,9,16,13,13,11,18,16,16,14,16,16,16,12,17,17,16,16,16,11,11,17,17,16,16,11,16,20,10,11,11,10,11,11,11,24,23,22,21,21,20,17,17,17,17,19,21,16,16,15,16,14,14,16,20,20,20,18,16,16,19,21,17,17,19,16,21,20,21,21,17,17,17,17,17,17,18,16,17,14,14,13,12,11,18,18,15,15,14,14,18,17,17,16,23,15,14,14,13,13,11,11,14,13,16,15,14,14,13,11,14,12,11,11,17,16,14,12,16,19,17,17,16,17,18,19,16,14,13,13,13,13,13,13,18,18,17,17,17,17,23,24,23,24,22,21,22,21,15,19,20,19,18,18,18,18,20,18,18,18,18,18,16,15,20,17,22,24,20,20,17,17,20,13,19,19,18,18,17,17,17,17,16,21,21,19,18,18,12,12,17,19,14,15,14,15,18,18,18,18,14,14,17,16,24,24,20,20,13,13,12,12,14,15,14,15,16,17,18,15,20,19,22,18,17,18,16,16,15,14,15,16,17,21,23,25,22,26,22,23,23,23,23,18,18,16,17,16,14,17,16,16,16,16,16,17,16,16,16,16,16,17,16,17,16,15,15,15,15,15,15,15,15,15,15,15,15,9,14,13,12,12,16,16,16,16,14,13,14,13,14,13,13,13,13,13,13,13,14,11,17,17,20,20,19,17,19,19,19,19,18,17,18,17,14,14,20,21,23,18,18,15,16,19,17,20,19,20,18,20,19,27,27,27,27,13,13,13,19,17,19,16,18,20,17,20,17,18,20,20,16,17,18,20,20,17,20,20,17,17,20,20,17,17,17,20,20,17,17,22,22,21,22,22,21,20,20,18,18,17,17,17,17,16,15,15,15,20,20,23,23,23,23,18,16,15,15,14,19,21,21,18,18,20,21,18,18,25,23,21,22,26,28,22,28,30,19,17,19,16,12,25,22,26,22,23,23,48,21,21,20,19,14,13,17,16,18,18,16,14,17,16,14,16,14,14,13,32,28,21,21,21,19,19,21,19,19,32,28,21,21,19,19,31,30,21,19,31,28,20,21,22,19,32,30,21,19,22,19,21,19,19,19,23,17,17,19,18,17,19,19,23,17,17,19,18,17,14,11,14,12,17,18,19,19,19,19,17,19,19,18,18,19,16,16,17,18,16,17,17,19,19,19,19,17,18,19,17,17,18,16,16,16,15,14,13,16],"text":["hwy: 21<br />cty: 15","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 24<br />cty: 16","hwy: 31<br />cty: 24","hwy: 28<br />cty: 20","hwy: 31<br />cty: 22","hwy: 26<br />cty: 18","hwy: 26<br />cty: 18","hwy: 27<br />cty: 19","hwy: 28<br />cty: 20","hwy: 18<br />cty: 11","hwy: 16<br />cty: 10","hwy: 17<br />cty: 11","hwy: 16<br />cty: 10","hwy: 16<br />cty: 10","hwy: 27<br />cty: 20","hwy: 29<br />cty: 20","hwy: 26<br />cty: 19","hwy: 30<br />cty: 21","hwy: 31<br />cty: 20","hwy: 28<br />cty: 19","hwy: 26<br />cty: 18","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 28<br />cty: 20","hwy: 27<br />cty: 19","hwy: 24<br />cty: 17","hwy: 28<br />cty: 20","hwy: 26<br />cty: 18","hwy: 24<br />cty: 16","hwy: 27<br />cty: 19","hwy: 26<br />cty: 18","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 28<br />cty: 20","hwy: 27<br />cty: 19","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 19<br />cty: 13","hwy: 21<br />cty: 14","hwy: 20<br />cty: 15","hwy: 19<br />cty: 14","hwy: 20<br />cty: 13","hwy: 21<br />cty: 14","hwy: 20<br />cty: 13","hwy: 21<br />cty: 14","hwy: 20<br />cty: 13","hwy: 20<br />cty: 14","hwy: 27<br />cty: 18","hwy: 26<br />cty: 18","hwy: 24<br />cty: 17","hwy: 26<br />cty: 18","hwy: 26<br />cty: 18","hwy: 23<br />cty: 17","hwy: 13<br />cty:  9","hwy: 13<br />cty:  9","hwy: 16<br />cty: 10","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 25<br />cty: 17","hwy: 24<br />cty: 16","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 28<br />cty: 19","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 25<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 27<br />cty: 18","hwy: 26<br />cty: 17","hwy: 23<br />cty: 16","hwy: 25<br />cty: 17","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 27<br />cty: 18","hwy: 27<br />cty: 18","hwy: 23<br />cty: 16","hwy: 26<br />cty: 17","hwy: 26<br />cty: 17","hwy: 27<br />cty: 18","hwy: 27<br />cty: 18","hwy: 26<br />cty: 17","hwy: 23<br />cty: 15","hwy: 24<br />cty: 16","hwy: 22<br />cty: 15","hwy: 23<br />cty: 15","hwy: 24<br />cty: 16","hwy: 22<br />cty: 15","hwy: 21<br />cty: 13","hwy: 24<br />cty: 16","hwy: 21<br />cty: 13","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 21<br />cty: 13","hwy: 21<br />cty: 13","hwy: 22<br />cty: 15","hwy: 21<br />cty: 15","hwy: 21<br />cty: 14","hwy: 20<br />cty: 14","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 23<br />cty: 15","hwy: 21<br />cty: 14","hwy: 20<br />cty: 13","hwy: 19<br />cty: 14","hwy: 20<br />cty: 14","hwy: 20<br />cty: 14","hwy: 26<br />cty: 18","hwy: 26<br />cty: 18","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 27<br />cty: 18","hwy: 27<br />cty: 18","hwy: 25<br />cty: 17","hwy: 27<br />cty: 18","hwy: 27<br />cty: 18","hwy: 26<br />cty: 17","hwy: 27<br />cty: 18","hwy: 20<br />cty: 14","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 17<br />cty: 14","hwy: 22<br />cty: 16","hwy: 23<br />cty: 16","hwy: 24<br />cty: 17","hwy: 24<br />cty: 16","hwy: 21<br />cty: 15","hwy: 23<br />cty: 16","hwy: 18<br />cty: 13","hwy: 25<br />cty: 16","hwy: 25<br />cty: 16","hwy: 24<br />cty: 15","hwy: 24<br />cty: 16","hwy: 21<br />cty: 13","hwy: 22<br />cty: 15","hwy: 24<br />cty: 16","hwy: 19<br />cty: 14","hwy: 17<br />cty: 13","hwy: 16<br />cty: 12","hwy: 16<br />cty: 12","hwy: 16<br />cty: 12","hwy: 18<br />cty: 13","hwy: 20<br />cty: 13","hwy: 22<br />cty: 15","hwy: 19<br />cty: 14","hwy: 21<br />cty: 14","hwy: 19<br />cty: 14","hwy: 23<br />cty: 16","hwy: 23<br />cty: 15","hwy: 21<br />cty: 14","hwy: 23<br />cty: 15","hwy: 20<br />cty: 15","hwy: 19<br />cty: 14","hwy: 20<br />cty: 14","hwy: 18<br />cty: 14","hwy: 16<br />cty: 12","hwy: 16<br />cty: 12","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 31<br />cty: 23","hwy: 32<br />cty: 23","hwy: 31<br />cty: 23","hwy: 32<br />cty: 23","hwy: 20<br />cty: 15","hwy: 20<br />cty: 14","hwy: 18<br />cty: 14","hwy: 17<br />cty: 13","hwy: 31<br />cty: 21","hwy: 33<br />cty: 23","hwy: 31<br />cty: 22","hwy: 27<br />cty: 20","hwy: 29<br />cty: 21","hwy: 31<br />cty: 22","hwy: 23<br />cty: 16","hwy: 24<br />cty: 18","hwy: 22<br />cty: 16","hwy: 23<br />cty: 17","hwy: 21<br />cty: 15","hwy: 22<br />cty: 17","hwy: 21<br />cty: 16","hwy: 22<br />cty: 17","hwy: 23<br />cty: 16","hwy: 24<br />cty: 18","hwy: 22<br />cty: 16","hwy: 21<br />cty: 15","hwy: 22<br />cty: 17","hwy: 21<br />cty: 16","hwy: 24<br />cty: 16","hwy: 26<br />cty: 16","hwy: 25<br />cty: 18","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 29<br />cty: 19","hwy: 26<br />cty: 17","hwy: 27<br />cty: 18","hwy: 27<br />cty: 17","hwy: 32<br />cty: 21","hwy: 29<br />cty: 20","hwy: 28<br />cty: 20","hwy: 29<br />cty: 19","hwy: 26<br />cty: 17","hwy: 28<br />cty: 18","hwy: 28<br />cty: 20","hwy: 27<br />cty: 20","hwy: 28<br />cty: 20","hwy: 27<br />cty: 20","hwy: 26<br />cty: 18","hwy: 27<br />cty: 18","hwy: 19<br />cty: 16","hwy: 18<br />cty: 15","hwy: 19<br />cty: 14","hwy: 20<br />cty: 14","hwy: 19<br />cty: 15","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 14","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 18<br />cty: 14","hwy: 18<br />cty: 14","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 15<br />cty: 12","hwy: 12<br />cty: 10","hwy: 11<br />cty:  8","hwy: 11<br />cty:  8","hwy: 18<br />cty: 14","hwy: 19<br />cty: 12","hwy: 18<br />cty: 14","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 20<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 13","hwy: 17<br />cty: 12","hwy: 18<br />cty: 13","hwy: 21<br />cty: 15","hwy: 23<br />cty: 16","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 17<br />cty: 13","hwy: 24<br />cty: 17","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 26<br />cty: 18","hwy: 25<br />cty: 17","hwy: 23<br />cty: 15","hwy: 18<br />cty: 13","hwy: 25<br />cty: 19","hwy: 22<br />cty: 15","hwy: 23<br />cty: 15","hwy: 25<br />cty: 19","hwy: 22<br />cty: 15","hwy: 23<br />cty: 15","hwy: 21<br />cty: 15","hwy: 23<br />cty: 16","hwy: 20<br />cty: 15","hwy: 24<br />cty: 17","hwy: 24<br />cty: 19","hwy: 25<br />cty: 19","hwy: 26<br />cty: 19","hwy: 24<br />cty: 17","hwy: 24<br />cty: 19","hwy: 25<br />cty: 19","hwy: 26<br />cty: 19","hwy: 26<br />cty: 19","hwy: 29<br />cty: 21","hwy: 25<br />cty: 18","hwy: 27<br />cty: 18","hwy: 25<br />cty: 18","hwy: 27<br />cty: 20","hwy: 25<br />cty: 19","hwy: 25<br />cty: 19","hwy: 27<br />cty: 20","hwy: 25<br />cty: 19","hwy: 25<br />cty: 19","hwy: 24<br />cty: 17","hwy: 23<br />cty: 16","hwy: 23<br />cty: 16","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 23<br />cty: 16","hwy: 23<br />cty: 16","hwy: 20<br />cty: 15","hwy: 20<br />cty: 14","hwy: 18<br />cty: 14","hwy: 19<br />cty: 13","hwy: 18<br />cty: 14","hwy: 19<br />cty: 15","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 14","hwy: 17<br />cty: 13","hwy: 17<br />cty: 12","hwy: 17<br />cty: 12","hwy: 17<br />cty: 12","hwy: 26<br />cty: 18","hwy: 25<br />cty: 17","hwy: 23<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 29<br />cty: 22","hwy: 32<br />cty: 25","hwy: 28<br />cty: 19","hwy: 19<br />cty: 14","hwy: 20<br />cty: 14","hwy: 17<br />cty: 13","hwy: 17<br />cty: 12","hwy: 11<br />cty:  8","hwy: 14<br />cty:  9","hwy: 14<br />cty: 11","hwy: 17<br />cty: 13","hwy: 17<br />cty: 12","hwy: 16<br />cty: 12","hwy: 14<br />cty: 11","hwy: 16<br />cty: 12","hwy: 26<br />cty: 19","hwy: 29<br />cty: 21","hwy: 25<br />cty: 18","hwy: 27<br />cty: 18","hwy: 25<br />cty: 18","hwy: 27<br />cty: 20","hwy: 25<br />cty: 19","hwy: 25<br />cty: 19","hwy: 19<br />cty: 11","hwy: 15<br />cty: 10","hwy: 15<br />cty: 10","hwy: 15<br />cty:  9","hwy: 16<br />cty:  9","hwy: 15<br />cty: 10","hwy: 16<br />cty:  9","hwy: 15<br />cty: 10","hwy: 16<br />cty: 10","hwy: 23<br />cty: 16","hwy: 20<br />cty: 14","hwy: 17<br />cty: 13","hwy: 15<br />cty: 12","hwy: 18<br />cty: 13","hwy: 16<br />cty: 13","hwy: 17<br />cty: 13","hwy: 23<br />cty: 19","hwy: 27<br />cty: 21","hwy: 23<br />cty: 17","hwy: 20<br />cty: 17","hwy: 24<br />cty: 19","hwy: 20<br />cty: 16","hwy: 28<br />cty: 30","hwy: 26<br />cty: 28","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 13","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 19<br />cty: 13","hwy: 18<br />cty: 13","hwy: 18<br />cty: 14","hwy: 19<br />cty: 13","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 16<br />cty: 12","hwy: 17<br />cty: 13","hwy: 23<br />cty: 17","hwy: 25<br />cty: 18","hwy: 26<br />cty: 19","hwy: 29<br />cty: 22","hwy: 32<br />cty: 22","hwy: 28<br />cty: 20","hwy: 29<br />cty: 22","hwy: 32<br />cty: 22","hwy: 22<br />cty: 16","hwy: 21<br />cty: 16","hwy: 22<br />cty: 16","hwy: 21<br />cty: 16","hwy: 22<br />cty: 17","hwy: 25<br />cty: 18","hwy: 19<br />cty: 12","hwy: 23<br />cty: 17","hwy: 26<br />cty: 17","hwy: 22<br />cty: 16","hwy: 23<br />cty: 15","hwy: 24<br />cty: 19","hwy: 27<br />cty: 21","hwy: 21<br />cty: 16","hwy: 21<br />cty: 16","hwy: 21<br />cty: 15","hwy: 21<br />cty: 16","hwy: 19<br />cty: 15","hwy: 19<br />cty: 15","hwy: 18<br />cty: 14","hwy: 17<br />cty: 14","hwy: 25<br />cty: 18","hwy: 25<br />cty: 18","hwy: 25<br />cty: 17","hwy: 23<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 23<br />cty: 16","hwy: 24<br />cty: 18","hwy: 22<br />cty: 16","hwy: 23<br />cty: 17","hwy: 21<br />cty: 15","hwy: 22<br />cty: 17","hwy: 21<br />cty: 16","hwy: 22<br />cty: 17","hwy: 23<br />cty: 16","hwy: 24<br />cty: 18","hwy: 22<br />cty: 16","hwy: 21<br />cty: 15","hwy: 22<br />cty: 17","hwy: 21<br />cty: 16","hwy: 20<br />cty: 14","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 17<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 13","hwy: 17<br />cty: 12","hwy: 18<br />cty: 13","hwy: 18<br />cty: 13","hwy: 19<br />cty: 14","hwy: 17<br />cty: 12","hwy: 18<br />cty: 13","hwy: 20<br />cty: 15","hwy: 20<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 14","hwy: 16<br />cty: 12","hwy: 16<br />cty: 12","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 18<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 19<br />cty: 16","hwy: 18<br />cty: 15","hwy: 20<br />cty: 14","hwy: 20<br />cty: 14","hwy: 19<br />cty: 15","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 14","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 18<br />cty: 14","hwy: 18<br />cty: 14","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 15<br />cty: 12","hwy: 12<br />cty: 10","hwy: 11<br />cty:  8","hwy: 11<br />cty:  8","hwy: 19<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 16<br />cty: 12","hwy: 17<br />cty: 13","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 16<br />cty: 12","hwy: 17<br />cty: 13","hwy: 31<br />cty: 21","hwy: 31<br />cty: 23","hwy: 28<br />cty: 19","hwy: 27<br />cty: 18","hwy: 33<br />cty: 25","hwy: 36<br />cty: 29","hwy: 34<br />cty: 25","hwy: 35<br />cty: 26","hwy: 34<br />cty: 27","hwy: 39<br />cty: 31","hwy: 34<br />cty: 27","hwy: 28<br />cty: 22","hwy: 31<br />cty: 26","hwy: 43<br />cty: 39","hwy: 42<br />cty: 39","hwy: 45<br />cty: 37","hwy: 45<br />cty: 38","hwy: 26<br />cty: 20","hwy: 25<br />cty: 20","hwy: 24<br />cty: 19","hwy: 24<br />cty: 19","hwy: 23<br />cty: 19","hwy: 23<br />cty: 19","hwy: 22<br />cty: 18","hwy: 49<br />cty: 45","hwy: 58<br />cty: 48","hwy: 26<br />cty: 17","hwy: 23<br />cty: 17","hwy: 20<br />cty: 15","hwy: 23<br />cty: 17","hwy: 32<br />cty: 23","hwy: 33<br />cty: 24","hwy: 32<br />cty: 23","hwy: 30<br />cty: 25","hwy: 29<br />cty: 21","hwy: 31<br />cty: 23","hwy: 24<br />cty: 18","hwy: 25<br />cty: 18","hwy: 23<br />cty: 17","hwy: 22<br />cty: 16","hwy: 21<br />cty: 16","hwy: 21<br />cty: 15","hwy: 27<br />cty: 19","hwy: 28<br />cty: 20","hwy: 25<br />cty: 17","hwy: 25<br />cty: 18","hwy: 27<br />cty: 19","hwy: 28<br />cty: 21","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 16","hwy: 25<br />cty: 19","hwy: 25<br />cty: 20","hwy: 24<br />cty: 18","hwy: 24<br />cty: 19","hwy: 23<br />cty: 17","hwy: 24<br />cty: 16","hwy: 20<br />cty: 15","hwy: 22<br />cty: 15","hwy: 18<br />cty: 14","hwy: 24<br />cty: 17","hwy: 23<br />cty: 16","hwy: 22<br />cty: 16","hwy: 23<br />cty: 16","hwy: 22<br />cty: 16","hwy: 18<br />cty: 12","hwy: 17<br />cty: 12","hwy: 20<br />cty: 14","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 13","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 25<br />cty: 16","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 25<br />cty: 16","hwy: 24<br />cty: 16","hwy: 25<br />cty: 17","hwy: 23<br />cty: 16","hwy: 25<br />cty: 16","hwy: 24<br />cty: 17","hwy: 25<br />cty: 17","hwy: 23<br />cty: 16","hwy: 25<br />cty: 16","hwy: 25<br />cty: 16","hwy: 25<br />cty: 16","hwy: 22<br />cty: 15","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 21<br />cty: 14","hwy: 21<br />cty: 14","hwy: 21<br />cty: 15","hwy: 18<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 15","hwy: 18<br />cty: 13","hwy: 19<br />cty: 14","hwy: 24<br />cty: 18","hwy: 20<br />cty: 15","hwy: 20<br />cty: 16","hwy: 22<br />cty: 18","hwy: 20<br />cty: 15","hwy: 20<br />cty: 16","hwy: 24<br />cty: 19","hwy: 19<br />cty: 16","hwy: 16<br />cty: 13","hwy: 17<br />cty: 13","hwy: 23<br />cty: 15","hwy: 28<br />cty: 19","hwy: 27<br />cty: 20","hwy: 25<br />cty: 18","hwy: 26<br />cty: 18","hwy: 29<br />cty: 21","hwy: 29<br />cty: 22","hwy: 21<br />cty: 14","hwy: 20<br />cty: 14","hwy: 19<br />cty: 15","hwy: 18<br />cty: 13","hwy: 18<br />cty: 14","hwy: 31<br />cty: 21","hwy: 30<br />cty: 22","hwy: 25<br />cty: 19","hwy: 25<br />cty: 20","hwy: 23<br />cty: 17","hwy: 24<br />cty: 19","hwy: 21<br />cty: 17","hwy: 14<br />cty:  8","hwy: 16<br />cty:  9","hwy: 12<br />cty:  8","hwy: 14<br />cty:  9","hwy: 19<br />cty: 16","hwy: 18<br />cty: 13","hwy: 17<br />cty: 13","hwy: 15<br />cty: 11","hwy: 27<br />cty: 18","hwy: 23<br />cty: 16","hwy: 22<br />cty: 16","hwy: 18<br />cty: 14","hwy: 23<br />cty: 16","hwy: 23<br />cty: 16","hwy: 23<br />cty: 16","hwy: 16<br />cty: 12","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 17<br />cty: 11","hwy: 16<br />cty: 11","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 17<br />cty: 11","hwy: 23<br />cty: 16","hwy: 25<br />cty: 20","hwy: 15<br />cty: 10","hwy: 16<br />cty: 11","hwy: 14<br />cty: 11","hwy: 15<br />cty: 10","hwy: 16<br />cty: 11","hwy: 16<br />cty: 11","hwy: 16<br />cty: 11","hwy: 32<br />cty: 24","hwy: 31<br />cty: 23","hwy: 29<br />cty: 22","hwy: 26<br />cty: 21","hwy: 28<br />cty: 21","hwy: 26<br />cty: 20","hwy: 24<br />cty: 17","hwy: 25<br />cty: 17","hwy: 24<br />cty: 17","hwy: 25<br />cty: 17","hwy: 24<br />cty: 19","hwy: 27<br />cty: 21","hwy: 21<br />cty: 16","hwy: 21<br />cty: 16","hwy: 21<br />cty: 15","hwy: 21<br />cty: 16","hwy: 18<br />cty: 14","hwy: 17<br />cty: 14","hwy: 23<br />cty: 16","hwy: 26<br />cty: 20","hwy: 26<br />cty: 20","hwy: 26<br />cty: 20","hwy: 24<br />cty: 18","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 23<br />cty: 19","hwy: 27<br />cty: 21","hwy: 23<br />cty: 17","hwy: 20<br />cty: 17","hwy: 24<br />cty: 19","hwy: 20<br />cty: 16","hwy: 29<br />cty: 21","hwy: 29<br />cty: 20","hwy: 29<br />cty: 21","hwy: 28<br />cty: 21","hwy: 23<br />cty: 17","hwy: 22<br />cty: 17","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 18","hwy: 22<br />cty: 16","hwy: 22<br />cty: 17","hwy: 20<br />cty: 14","hwy: 22<br />cty: 14","hwy: 20<br />cty: 13","hwy: 17<br />cty: 12","hwy: 18<br />cty: 11","hwy: 26<br />cty: 18","hwy: 24<br />cty: 18","hwy: 23<br />cty: 15","hwy: 23<br />cty: 15","hwy: 21<br />cty: 14","hwy: 21<br />cty: 14","hwy: 26<br />cty: 18","hwy: 25<br />cty: 17","hwy: 23<br />cty: 17","hwy: 22<br />cty: 16","hwy: 33<br />cty: 23","hwy: 23<br />cty: 15","hwy: 19<br />cty: 14","hwy: 18<br />cty: 14","hwy: 19<br />cty: 13","hwy: 19<br />cty: 13","hwy: 13<br />cty: 11","hwy: 13<br />cty: 11","hwy: 17<br />cty: 14","hwy: 16<br />cty: 13","hwy: 24<br />cty: 16","hwy: 21<br />cty: 15","hwy: 22<br />cty: 14","hwy: 20<br />cty: 14","hwy: 20<br />cty: 13","hwy: 17<br />cty: 11","hwy: 21<br />cty: 14","hwy: 18<br />cty: 12","hwy: 18<br />cty: 11","hwy: 18<br />cty: 11","hwy: 23<br />cty: 17","hwy: 23<br />cty: 16","hwy: 20<br />cty: 14","hwy: 16<br />cty: 12","hwy: 23<br />cty: 16","hwy: 24<br />cty: 19","hwy: 23<br />cty: 17","hwy: 21<br />cty: 17","hwy: 21<br />cty: 16","hwy: 23<br />cty: 17","hwy: 25<br />cty: 18","hwy: 26<br />cty: 19","hwy: 21<br />cty: 16","hwy: 19<br />cty: 14","hwy: 18<br />cty: 13","hwy: 19<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 19<br />cty: 13","hwy: 17<br />cty: 13","hwy: 25<br />cty: 18","hwy: 25<br />cty: 18","hwy: 25<br />cty: 17","hwy: 23<br />cty: 17","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 31<br />cty: 23","hwy: 33<br />cty: 24","hwy: 30<br />cty: 23","hwy: 32<br />cty: 24","hwy: 29<br />cty: 22","hwy: 29<br />cty: 21","hwy: 29<br />cty: 22","hwy: 29<br />cty: 21","hwy: 23<br />cty: 15","hwy: 25<br />cty: 19","hwy: 28<br />cty: 20","hwy: 25<br />cty: 19","hwy: 27<br />cty: 18","hwy: 26<br />cty: 18","hwy: 25<br />cty: 18","hwy: 25<br />cty: 18","hwy: 28<br />cty: 20","hwy: 24<br />cty: 18","hwy: 26<br />cty: 18","hwy: 26<br />cty: 18","hwy: 25<br />cty: 18","hwy: 25<br />cty: 18","hwy: 21<br />cty: 16","hwy: 20<br />cty: 15","hwy: 27<br />cty: 20","hwy: 25<br />cty: 17","hwy: 28<br />cty: 22","hwy: 31<br />cty: 24","hwy: 26<br />cty: 20","hwy: 27<br />cty: 20","hwy: 24<br />cty: 17","hwy: 23<br />cty: 17","hwy: 26<br />cty: 20","hwy: 17<br />cty: 13","hwy: 25<br />cty: 19","hwy: 24<br />cty: 19","hwy: 25<br />cty: 18","hwy: 23<br />cty: 18","hwy: 24<br />cty: 17","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 24<br />cty: 17","hwy: 23<br />cty: 16","hwy: 27<br />cty: 21","hwy: 29<br />cty: 21","hwy: 25<br />cty: 19","hwy: 26<br />cty: 18","hwy: 28<br />cty: 18","hwy: 18<br />cty: 12","hwy: 17<br />cty: 12","hwy: 22<br />cty: 17","hwy: 23<br />cty: 19","hwy: 19<br />cty: 14","hwy: 20<br />cty: 15","hwy: 19<br />cty: 14","hwy: 19<br />cty: 15","hwy: 27<br />cty: 18","hwy: 26<br />cty: 18","hwy: 23<br />cty: 18","hwy: 23<br />cty: 18","hwy: 21<br />cty: 14","hwy: 19<br />cty: 14","hwy: 24<br />cty: 17","hwy: 23<br />cty: 16","hwy: 31<br />cty: 24","hwy: 32<br />cty: 24","hwy: 26<br />cty: 20","hwy: 27<br />cty: 20","hwy: 17<br />cty: 13","hwy: 17<br />cty: 13","hwy: 17<br />cty: 12","hwy: 17<br />cty: 12","hwy: 20<br />cty: 14","hwy: 21<br />cty: 15","hwy: 19<br />cty: 14","hwy: 19<br />cty: 15","hwy: 22<br />cty: 16","hwy: 24<br />cty: 17","hwy: 27<br />cty: 18","hwy: 22<br />cty: 15","hwy: 29<br />cty: 20","hwy: 26<br />cty: 19","hwy: 31<br />cty: 22","hwy: 27<br />cty: 18","hwy: 26<br />cty: 17","hwy: 27<br />cty: 18","hwy: 24<br />cty: 16","hwy: 25<br />cty: 16","hwy: 23<br />cty: 15","hwy: 19<br />cty: 14","hwy: 21<br />cty: 15","hwy: 23<br />cty: 16","hwy: 24<br />cty: 17","hwy: 31<br />cty: 21","hwy: 32<br />cty: 23","hwy: 31<br />cty: 25","hwy: 29<br />cty: 22","hwy: 33<br />cty: 26","hwy: 29<br />cty: 22","hwy: 31<br />cty: 23","hwy: 32<br />cty: 23","hwy: 31<br />cty: 23","hwy: 32<br />cty: 23","hwy: 27<br />cty: 18","hwy: 26<br />cty: 18","hwy: 24<br />cty: 16","hwy: 25<br />cty: 17","hwy: 24<br />cty: 16","hwy: 21<br />cty: 14","hwy: 24<br />cty: 17","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 17","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 17","hwy: 24<br />cty: 16","hwy: 24<br />cty: 17","hwy: 24<br />cty: 16","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 22<br />cty: 15","hwy: 21<br />cty: 15","hwy: 22<br />cty: 15","hwy: 21<br />cty: 15","hwy: 22<br />cty: 15","hwy: 15<br />cty:  9","hwy: 18<br />cty: 14","hwy: 19<br />cty: 13","hwy: 17<br />cty: 12","hwy: 17<br />cty: 12","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 24<br />cty: 16","hwy: 22<br />cty: 14","hwy: 20<br />cty: 13","hwy: 21<br />cty: 14","hwy: 20<br />cty: 13","hwy: 21<br />cty: 14","hwy: 20<br />cty: 13","hwy: 20<br />cty: 13","hwy: 20<br />cty: 13","hwy: 20<br />cty: 13","hwy: 20<br />cty: 13","hwy: 20<br />cty: 13","hwy: 20<br />cty: 13","hwy: 21<br />cty: 14","hwy: 17<br />cty: 11","hwy: 23<br />cty: 17","hwy: 24<br />cty: 17","hwy: 26<br />cty: 20","hwy: 27<br />cty: 20","hwy: 26<br />cty: 19","hwy: 25<br />cty: 17","hwy: 29<br />cty: 19","hwy: 28<br />cty: 19","hwy: 26<br />cty: 19","hwy: 28<br />cty: 19","hwy: 28<br />cty: 18","hwy: 26<br />cty: 17","hwy: 28<br />cty: 18","hwy: 26<br />cty: 17","hwy: 19<br />cty: 14","hwy: 17<br />cty: 14","hwy: 27<br />cty: 20","hwy: 29<br />cty: 21","hwy: 32<br />cty: 23","hwy: 26<br />cty: 18","hwy: 26<br />cty: 18","hwy: 21<br />cty: 15","hwy: 23<br />cty: 16","hwy: 24<br />cty: 19","hwy: 23<br />cty: 17","hwy: 26<br />cty: 20","hwy: 25<br />cty: 19","hwy: 27<br />cty: 20","hwy: 25<br />cty: 18","hwy: 27<br />cty: 20","hwy: 27<br />cty: 19","hwy: 35<br />cty: 27","hwy: 34<br />cty: 27","hwy: 32<br />cty: 27","hwy: 31<br />cty: 27","hwy: 18<br />cty: 13","hwy: 18<br />cty: 13","hwy: 18<br />cty: 13","hwy: 25<br />cty: 19","hwy: 23<br />cty: 17","hwy: 25<br />cty: 19","hwy: 21<br />cty: 16","hwy: 22<br />cty: 18","hwy: 26<br />cty: 20","hwy: 22<br />cty: 17","hwy: 27<br />cty: 20","hwy: 24<br />cty: 17","hwy: 25<br />cty: 18","hwy: 26<br />cty: 20","hwy: 27<br />cty: 20","hwy: 22<br />cty: 16","hwy: 24<br />cty: 17","hwy: 25<br />cty: 18","hwy: 26<br />cty: 20","hwy: 27<br />cty: 20","hwy: 23<br />cty: 17","hwy: 27<br />cty: 20","hwy: 27<br />cty: 20","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 27<br />cty: 20","hwy: 27<br />cty: 20","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 26<br />cty: 20","hwy: 26<br />cty: 20","hwy: 23<br />cty: 17","hwy: 23<br />cty: 17","hwy: 28<br />cty: 22","hwy: 28<br />cty: 22","hwy: 26<br />cty: 21","hwy: 28<br />cty: 22","hwy: 28<br />cty: 22","hwy: 26<br />cty: 21","hwy: 28<br />cty: 20","hwy: 27<br />cty: 20","hwy: 26<br />cty: 18","hwy: 27<br />cty: 18","hwy: 20<br />cty: 17","hwy: 21<br />cty: 17","hwy: 20<br />cty: 17","hwy: 20<br />cty: 17","hwy: 21<br />cty: 16","hwy: 20<br />cty: 15","hwy: 20<br />cty: 15","hwy: 20<br />cty: 15","hwy: 28<br />cty: 20","hwy: 27<br />cty: 20","hwy: 31<br />cty: 23","hwy: 32<br />cty: 23","hwy: 31<br />cty: 23","hwy: 32<br />cty: 23","hwy: 25<br />cty: 18","hwy: 20<br />cty: 16","hwy: 18<br />cty: 15","hwy: 19<br />cty: 15","hwy: 18<br />cty: 14","hwy: 28<br />cty: 19","hwy: 31<br />cty: 21","hwy: 30<br />cty: 21","hwy: 26<br />cty: 18","hwy: 27<br />cty: 18","hwy: 29<br />cty: 20","hwy: 30<br />cty: 21","hwy: 27<br />cty: 18","hwy: 26<br />cty: 18","hwy: 33<br />cty: 25","hwy: 30<br />cty: 23","hwy: 30<br />cty: 21","hwy: 28<br />cty: 22","hwy: 35<br />cty: 26","hwy: 37<br />cty: 28","hwy: 31<br />cty: 22","hwy: 36<br />cty: 28","hwy: 38<br />cty: 30","hwy: 25<br />cty: 19","hwy: 23<br />cty: 17","hwy: 23<br />cty: 19","hwy: 22<br />cty: 16","hwy: 16<br />cty: 12","hwy: 31<br />cty: 25","hwy: 29<br />cty: 22","hwy: 33<br />cty: 26","hwy: 29<br />cty: 22","hwy: 29<br />cty: 23","hwy: 30<br />cty: 23","hwy: 45<br />cty: 48","hwy: 27<br />cty: 21","hwy: 27<br />cty: 21","hwy: 24<br />cty: 20","hwy: 25<br />cty: 19","hwy: 17<br />cty: 14","hwy: 16<br />cty: 13","hwy: 24<br />cty: 17","hwy: 22<br />cty: 16","hwy: 24<br />cty: 18","hwy: 25<br />cty: 18","hwy: 21<br />cty: 16","hwy: 19<br />cty: 14","hwy: 21<br />cty: 17","hwy: 20<br />cty: 16","hwy: 18<br />cty: 14","hwy: 20<br />cty: 16","hwy: 19<br />cty: 14","hwy: 17<br />cty: 14","hwy: 17<br />cty: 13","hwy: 41<br />cty: 32","hwy: 39<br />cty: 28","hwy: 28<br />cty: 21","hwy: 28<br />cty: 21","hwy: 29<br />cty: 21","hwy: 27<br />cty: 19","hwy: 27<br />cty: 19","hwy: 29<br />cty: 21","hwy: 27<br />cty: 19","hwy: 27<br />cty: 19","hwy: 41<br />cty: 32","hwy: 39<br />cty: 28","hwy: 28<br />cty: 21","hwy: 28<br />cty: 21","hwy: 28<br />cty: 19","hwy: 28<br />cty: 19","hwy: 39<br />cty: 31","hwy: 38<br />cty: 30","hwy: 29<br />cty: 21","hwy: 27<br />cty: 19","hwy: 39<br />cty: 31","hwy: 39<br />cty: 28","hwy: 27<br />cty: 20","hwy: 28<br />cty: 21","hwy: 28<br />cty: 22","hwy: 28<br />cty: 19","hwy: 41<br />cty: 32","hwy: 38<br />cty: 30","hwy: 28<br />cty: 21","hwy: 28<br />cty: 19","hwy: 28<br />cty: 22","hwy: 28<br />cty: 19","hwy: 28<br />cty: 21","hwy: 28<br />cty: 19","hwy: 28<br />cty: 19","hwy: 28<br />cty: 19","hwy: 34<br />cty: 23","hwy: 26<br />cty: 17","hwy: 25<br />cty: 17","hwy: 28<br />cty: 19","hwy: 26<br />cty: 18","hwy: 24<br />cty: 17","hwy: 28<br />cty: 19","hwy: 28<br />cty: 19","hwy: 34<br />cty: 23","hwy: 26<br />cty: 17","hwy: 25<br />cty: 17","hwy: 28<br />cty: 19","hwy: 26<br />cty: 18","hwy: 24<br />cty: 17","hwy: 21<br />cty: 14","hwy: 17<br />cty: 11","hwy: 19<br />cty: 14","hwy: 17<br />cty: 12","hwy: 25<br />cty: 17","hwy: 25<br />cty: 18","hwy: 27<br />cty: 19","hwy: 27<br />cty: 19","hwy: 29<br />cty: 19","hwy: 27<br />cty: 19","hwy: 24<br />cty: 17","hwy: 27<br />cty: 19","hwy: 27<br />cty: 19","hwy: 26<br />cty: 18","hwy: 26<br />cty: 18","hwy: 27<br />cty: 19","hwy: 23<br />cty: 16","hwy: 22<br />cty: 16","hwy: 24<br />cty: 17","hwy: 27<br />cty: 18","hwy: 24<br />cty: 16","hwy: 25<br />cty: 17","hwy: 24<br />cty: 17","hwy: 27<br />cty: 19","hwy: 27<br />cty: 19","hwy: 29<br />cty: 19","hwy: 27<br />cty: 19","hwy: 24<br />cty: 17","hwy: 26<br />cty: 18","hwy: 27<br />cty: 19","hwy: 24<br />cty: 17","hwy: 24<br />cty: 17","hwy: 27<br />cty: 18","hwy: 23<br />cty: 16","hwy: 22<br />cty: 16","hwy: 22<br />cty: 16","hwy: 20<br />cty: 15","hwy: 19<br />cty: 14","hwy: 19<br />cty: 13","hwy: 21<br />cty: 16"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":44.028227480282283,"r":7.3059360730593621,"b":41.511000415110011,"l":41.511000415110011},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"This is the title","font":{"color":"rgba(0,0,0,1)","family":"","size":20.722291407222919},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[8.6500000000000004,60.350000000000001],"tickmode":"array","ticktext":["10","20","30","40","50","60"],"tickvals":[10,20,30,40.000000000000007,50,60],"categoryorder":"array","categoryarray":["10","20","30","40","50","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.611872146118724},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Highway fuel economy (mpg)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[6,50],"tickmode":"array","ticktext":["10","20","30","40","50"],"tickvals":[10,20,30,40,50],"categoryorder":"array","categoryarray":["10","20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.611872146118724},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"City fuel economy (mpg)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"93f356f9e928":{"x":{},"y":{},"type":"scatter"}},"cur_data":"93f356f9e928","visdat":{"93f356f9e928":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="adding-statistical-information-to-plots" class="level1">
<h1>Adding statistical information to plots</h1>
<ul>
<li>TODO - e.g.&nbsp;using <code>ggsignif</code>, <code>ggstatsplot</code></li>
</ul>
</section>
<section id="adding-text-and-annotation" class="level1">
<h1>Adding text and annotation</h1>
<p>Sometimes it is useful to outline a subset of the observations, enclosing them in an ellipse (<code>ggforce::geom_mark_circle</code>) or a polygon (<code>ggalt::geom_encircle</code>):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggforce</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_mark_ellipse</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">"Interesting points"</span>, </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">description =</span> <span class="st">"These points are interesting"</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">filter =</span> (cty <span class="sc">-</span> hwy) <span class="sc">&gt;</span> <span class="dv">1</span>), </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggalt</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Width, <span class="at">y =</span> Sepal.Width, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_encircle</span>(<span class="fu">aes</span>(<span class="at">group =</span> Species)) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>gghighlight::gghighlight</code> function allows to highlight observations that fulfill specific criteria for most geoms:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## gghighlight</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(carat, cut) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_price =</span> <span class="fu">mean</span>(price)),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> mean_price, <span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gghighlight</span>(cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Good"</span>, <span class="st">"Ideal"</span>)) <span class="sc">+</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> cut) <span class="sc">+</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'carat'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Tried to calculate with group_by(), but the calculation failed.
Falling back to ungrouped filter operation...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>label_key: cut</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>ggrepel</code> is useful to add non-overlapping labels to observations in a scatter plot. <code>geom_text_repel</code> just adds the text labels, while <code>geom_label_repel</code> adds a filled background around each label:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span> <span class="sc">&amp;</span> hwy <span class="sc">&gt;</span> <span class="dv">30</span>), <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> model)) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 59 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span> <span class="sc">&amp;</span> hwy <span class="sc">&gt;</span> <span class="dv">30</span>), <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> model)) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray88"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 74 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that <code>ggrepel</code> will not show labels overlapping too many other things. This can be controlled with the <code>max.overlaps</code> argument (by default, this is set to 10). We can also instruct <code>ggrepel</code> to always draw a line to the corresponding point from a given label (even if they are very close) by setting<br>
<code>min.segment.length = 0</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span> <span class="sc">&amp;</span> hwy <span class="sc">&gt;</span> <span class="dv">30</span>), </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> model), <span class="at">max.overlaps =</span> <span class="dv">25</span>, </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min.segment.length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray88"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 55 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>directlabels</code> package can be useful for adding direct labels to a plot, typically replacing a legend. Labels can be added e.g.&nbsp;at the last point, first point or both.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Small Station Wagons"</span>, <span class="st">"Large Cars"</span>, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Vans, Passenger Type"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">group_by</span>(year, class) <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">median_hwy =</span> <span class="fu">median</span>(hwy), <span class="at">.groups =</span> <span class="st">"drop"</span>), </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">scale_colour_discrete</span>(<span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.5</span>))) <span class="sc">+</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_dl</span>(<span class="fu">aes</span>(<span class="at">label =</span> class), <span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">"last.points"</span>)), <span class="at">cex =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Other packages that are useful for annotation of graphs are <code>geomtextpath</code>, which allows adding curved text to <code>ggplot</code> objects, and <code>ggtext</code>, which provides improved support for text rendering (e.g.&nbsp;using <code>markdown</code>).</p>
<p>Here are some more tips for using annotations in ggplots: <a href="https://www.cararthompson.com/talks/user2022/">https://www.cararthompson.com/talks/user2022/</a>.</p>
</section>
<section id="customizing-legends" class="level1">
<h1>Customizing legends</h1>
<p><code>ggplot2</code> itself allows to control the placement of the legend in various ways.</p>
<section id="suppressing-the-legend" class="level2">
<h2 class="anchored" data-anchor-id="suppressing-the-legend">Suppressing the legend</h2>
<p><code>show.legend</code> can be used to exclude a single layer from the legend. Other layers will be unaffected:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(hwy, cty, <span class="at">color =</span> fuel)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(make <span class="sc">==</span> <span class="st">"Ram"</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(hwy, cty, <span class="at">shape =</span> model)) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>theme(legend.position = "none")</code> completely suppresses the legend:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(hwy, cty, <span class="at">color =</span> fuel)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="legend-position" class="level2">
<h2 class="anchored" data-anchor-id="legend-position">Legend position</h2>
<p>In addition to <code>"none"</code> which completely suppresses the legend, <code>theme(legend.position = "...")</code> also understands <code>"left"</code>, <code>"top"</code>, <code>"right"</code> and <code>"bottom"</code> to control the legend position (outside of the plot):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## legend position (outside of plot)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">## allowed values for the arguments legend.position are:</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="do">## "left", "top", "right", "bottom"</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(hwy, cty, <span class="at">color =</span> fuel)) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In order to place the legend <strong>inside</strong> the plot, we can use numerical coordinates for <code>legend.position</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="do">## move legend inside plot</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="do">## c(0,0) corresponds to the “bottom left” and</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="do">## c(1,1) corresponds to the “top right” position</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price, <span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"inside"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.98</span>, <span class="fl">0.02</span>),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="customizing-legend-formatting" class="level2">
<h2 class="anchored" data-anchor-id="customizing-legend-formatting">Customizing legend formatting</h2>
<p><code>guides(... = guide_legend())</code> is useful to control or override legend formatting parameters, such as the number of rows or the transparency of plot symbols:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## number of rows (discrete scales)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(hwy, cty, <span class="at">color =</span> fuel)) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title.hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">## override graphical parameters</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price, <span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    ggp <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="specifying-colors" class="level1">
<h1>Specifying colors</h1>
<p>There are many ways of specifying colors in ggplot2. Here we show a few examples.</p>
<section id="specifying-color-gradients-using-defined-colors" class="level2">
<h2 class="anchored" data-anchor-id="specifying-color-gradients-using-defined-colors">Specifying color gradients using defined colors</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## One-sided gradient</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">color =</span> cyl)) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Two-sided (divergent) gradient</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">color =</span> <span class="fu">scale</span>(cyl))) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>, </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-49-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Custom gradient</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">color =</span> <span class="fu">scale</span>(cyl))) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">hcl.colors</span>(<span class="dv">9</span>, <span class="st">"Spectral"</span>)) <span class="sc">+</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-49-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Manual colors</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">BMW =</span> <span class="st">"darkblue"</span>, <span class="at">Chevrolet =</span> <span class="st">"red"</span>, </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Ford =</span> <span class="st">"forestgreen"</span>, <span class="at">Other =</span> <span class="st">"grey85"</span>),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">"Make"</span>) <span class="sc">+</span> </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-49-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="named-color-palettes" class="level2">
<h2 class="anchored" data-anchor-id="named-color-palettes">Named color palettes</h2>
<p><code>RColorBrewer</code> comes with many discrete, sequential or divergent color palettes:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Colors from existing palettes</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="do">## RColorBrewer palettes</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>R</code> also has many built-in palettes, available using the <code>hcl.colors()</code> function. These also include widely used contributed palettes such as viridis or many of ColorBrewer palettes (see available names using <code>hcl.pals()</code>):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hcl.colors</span>(<span class="dv">3</span>, <span class="st">"Dark2"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#C87A8A" "#6B9D59" "#5F96C2"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hcl.pals</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Pastel 1"      "Dark 2"        "Dark 3"        "Set 2"        
  [5] "Set 3"         "Warm"          "Cold"          "Harmonic"     
  [9] "Dynamic"       "Grays"         "Light Grays"   "Blues 2"      
 [13] "Blues 3"       "Purples 2"     "Purples 3"     "Reds 2"       
 [17] "Reds 3"        "Greens 2"      "Greens 3"      "Oslo"         
 [21] "Purple-Blue"   "Red-Purple"    "Red-Blue"      "Purple-Orange"
 [25] "Purple-Yellow" "Blue-Yellow"   "Green-Yellow"  "Red-Yellow"   
 [29] "Heat"          "Heat 2"        "Terrain"       "Terrain 2"    
 [33] "Viridis"       "Plasma"        "Inferno"       "Rocket"       
 [37] "Mako"          "Dark Mint"     "Mint"          "BluGrn"       
 [41] "Teal"          "TealGrn"       "Emrld"         "BluYl"        
 [45] "ag_GrnYl"      "Peach"         "PinkYl"        "Burg"         
 [49] "BurgYl"        "RedOr"         "OrYel"         "Purp"         
 [53] "PurpOr"        "Sunset"        "Magenta"       "SunsetDark"   
 [57] "ag_Sunset"     "BrwnYl"        "YlOrRd"        "YlOrBr"       
 [61] "OrRd"          "Oranges"       "YlGn"          "YlGnBu"       
 [65] "Reds"          "RdPu"          "PuRd"          "Purples"      
 [69] "PuBuGn"        "PuBu"          "Greens"        "BuGn"         
 [73] "GnBu"          "BuPu"          "Blues"         "Lajolla"      
 [77] "Turku"         "Hawaii"        "Batlow"        "Blue-Red"     
 [81] "Blue-Red 2"    "Blue-Red 3"    "Red-Green"     "Purple-Green" 
 [85] "Purple-Brown"  "Green-Brown"   "Blue-Yellow 2" "Blue-Yellow 3"
 [89] "Green-Orange"  "Cyan-Magenta"  "Tropic"        "Broc"         
 [93] "Cork"          "Vik"           "Berlin"        "Lisbon"       
 [97] "Tofino"        "ArmyRose"      "Earth"         "Fall"         
[101] "Geyser"        "TealRose"      "Temps"         "PuOr"         
[105] "RdBu"          "RdGy"          "PiYG"          "PRGn"         
[109] "BrBG"          "RdYlBu"        "RdYlGn"        "Spectral"     
[113] "Zissou 1"      "Cividis"       "Roma"         </code></pre>
</div>
</div>
<p>The following code displays all palettes in <code>hcl.colors()</code> using code from <code>example(hcl.colors)</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>hcl.swatch <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">type =</span> <span class="cn">NULL</span>, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">nrow =</span> <span class="dv">12</span>,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="cf">if</span> (n <span class="sc">&lt;</span> <span class="dv">15</span>) <span class="st">"black"</span> <span class="cf">else</span> <span class="cn">NA</span>) {</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    palette <span class="ot">&lt;-</span> <span class="fu">hcl.pals</span>(type)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(palette, hcl.colors, <span class="at">n =</span> n)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    ncol <span class="ot">&lt;-</span> <span class="fu">ncol</span>(cols)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    nswatch <span class="ot">&lt;-</span> <span class="fu">min</span>(ncol, nrow)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">4</span>),</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">ceiling</span>(ncol<span class="sc">/</span>nrow))),</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">pin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span> <span class="sc">*</span> nswatch),</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (<span class="fu">length</span>(palette)) {</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        subset <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(nrow, <span class="fu">ncol</span>(cols))</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot.new</span>()</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot.window</span>(<span class="fu">c</span>(<span class="dv">0</span>, n), <span class="fu">c</span>(<span class="dv">0</span>, nrow <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">text</span>(<span class="dv">0</span>, <span class="fu">rev</span>(subset) <span class="sc">+</span> <span class="fl">0.1</span>, palette[subset], <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rep</span>(subset, <span class="at">each =</span> n)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rect</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>(n<span class="dv">-1</span>), n), <span class="fu">rev</span>(y), <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, n), <span class="fu">rev</span>(y) <span class="sc">-</span> <span class="fl">0.5</span>,</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> cols[, subset], <span class="at">border =</span> border)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>        palette <span class="ot">&lt;-</span> palette[<span class="sc">-</span>subset]</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>        cols <span class="ot">&lt;-</span> cols[, <span class="sc">-</span>subset, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>), <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="fu">hcl.swatch</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hcl.swatch("qualitative")</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hcl.swatch("sequential")</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hcl.swatch("diverging")</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># hcl.swatch("divergingx")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can use those named palettes in ggplot2 as follows:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Make"</span>) <span class="sc">+</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Greens"</span>, <span class="at">name =</span> <span class="st">"Make"</span>) <span class="sc">+</span> </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-53-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## viridis palettes</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">## viridis_c - continuous</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="do">## viridis_b - binned</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="do">## viridis_d - discrete</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">color =</span> <span class="fu">scale</span>(cyl))) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span> </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-53-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-53-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-multiple-color-scales-for-different-layers" class="level2">
<h2 class="anchored" data-anchor-id="using-multiple-color-scales-for-different-layers">Using multiple color scales for different layers</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## multiple scales for color or fill: ggnewscale::new_scale</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">color =</span> cyl)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">new_scale</span>(<span class="st">"color"</span>) <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> fuel), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cap-color-range" class="level2">
<h2 class="anchored" data-anchor-id="cap-color-range">Cap color range</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## - One way of doing it: limit color range + </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     set color for out-of-range NA values</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">hcl.colors</span>(<span class="dv">8</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> depth, <span class="at">color =</span> price)) <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradientn</span>(<span class="at">colors =</span> cols,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(diamonds<span class="sc">$</span>price), <span class="dv">10000</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">na.value =</span> cols[<span class="fu">length</span>(cols)]) <span class="sc">+</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Another way is to squish the out-of-bounds values to the nearest extreme</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="do">## using e.g. the scales::squish function (the default value of oob is </span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="do">## scales::censor, which sets the values to NA as in the previous example)</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> depth, <span class="at">color =</span> price)) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradientn</span>(<span class="at">colors =</span> cols,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">10000</span>),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span> </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="creating-darkerlighter-variants-of-a-color" class="level2">
<h2 class="anchored" data-anchor-id="creating-darkerlighter-variants-of-a-color">Creating darker/lighter variants of a color</h2>
<p>The functions in the <code>colorspace</code> package allow you to work with colors, for example create a darker or lighter variant of a color, using <code>darken()</code> or <code>lighten</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the box plot outlines a bit darker than the fill</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">hcl.colors</span>(<span class="fu">nlevels</span>(diamonds<span class="sc">$</span>clarity), <span class="st">"Dark2"</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cols) <span class="ot">&lt;-</span> <span class="fu">levels</span>(diamonds<span class="sc">$</span>clarity)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> clarity, <span class="at">y =</span> price, <span class="at">color =</span> clarity, <span class="at">fill =</span> clarity)) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colorspace<span class="sc">::</span><span class="fu">darken</span>(cols, <span class="at">amount =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorspace<span class="sc">::</span><span class="fu">lighten</span>(cols, <span class="at">amount =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="using-after_stat-previously-...." class="level1">
<h1>Using <code>after_stat</code> (previously <code>..*..</code>)</h1>
<p>(From <a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">here</a>): <code>ggplot2</code> has three stages of the data that you can map aesthetics from. The default is to map at the beginning, using the layer data provided by the user. The second stage is after the data has been transformed by the layer stat. The third and last stage is after the data has been transformed and mapped by the plot scales. The most common example of mapping from stat transformed data is the height of bars in <code>geom_histogram()</code>: the height does not come from a variable in the underlying data, but is instead mapped to the count computed by <code>stat_bin()</code>. In order to map from stat transformed data you should use the <code>after_stat()</code> function to flag that evaluation of the aesthetic mapping should be postponed until after stat transformation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This histogram code...</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ...is equivalent to</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> <span class="fu">after_stat</span>(count))) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-57-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="do">## To get the density instead:</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-57-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## In percentage</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span> </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-57-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Other transformations - scale so that max height = 1</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> <span class="fu">after_stat</span>(count<span class="sc">/</span><span class="fu">max</span>(count)))) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-57-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-plot-panels" class="level1">
<h1>Combining plot panels</h1>
<p>Several packages are available for combining multiple independent <code>ggplot</code> objects into panels of a single figure. Here we illustrate two of these.</p>
<section id="cowplot" class="level2">
<h2 class="anchored" data-anchor-id="cowplot">cowplot</h2>
<p>With the <code>cowplot</code> package, figures are combined using the <code>plot_grid()</code> function. We first create a few plots that we will use for illustration.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vehicles, </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump_n</span>(fuel, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">other_level =</span> <span class="st">"Other"</span>), </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">fct_lump_n</span>(make, <span class="at">n =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Make"</span>) <span class="sc">+</span> </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    ggp</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>), </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> cty, <span class="at">color =</span> <span class="fu">scale</span>(cyl))) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>, </span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    ggp</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vehicles <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_hwy =</span> <span class="fu">mean</span>(hwy)), </span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(class, mean_hwy), <span class="at">y =</span> mean_hwy)) <span class="sc">+</span> </span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>    ggp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next we use <code>cowplot::plot_grid</code> to combine g1 and g2 (without legend) into a single column.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(g12 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(g1, g2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>),</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">align =</span> <span class="st">"v"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>'align'</code> argument lets us specify how to align the individual panels.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(g12 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(g1, g2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>),</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">align =</span> <span class="st">"v"</span>, <span class="at">axis =</span> <span class="st">"lr"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also combine the outputs of <code>plot_grid</code> calls further. The relative widths of the components can be specified using the <code>rel_widths</code> argument (similarly for the relative heights and <code>rel_heights</code>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(g12, g3, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"C"</span>), </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Sometimes all our panels have a shared legend, which we don’t want to repeat in all the panels. At the same time, including it in one of the panels would make it difficult to decide on the relative sizes (we may want the actual plot area to be equally sized across the panels). One solution is to extract the legend from one of the panels and include it as a separate element in the combined plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_legend</span>(g1)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(g1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>), </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                   g1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>), </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">get_legend</span>(g1), </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.4</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>We can also add a shared plot title as a separate panel element.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>my_title <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">"A shared title for the plot"</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    my_title, </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(g1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>), </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                       g1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>), </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">get_legend</span>(g1), </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.4</span>)),</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><code>cowplot</code> doesn’t work directly with the output of <code>GGally::ggpairs</code>; for example:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>gp <span class="ot">&lt;-</span> <span class="fu">ggpairs</span>(vehicles <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(cty, hwy, cyl))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(gp, g1, <span class="at">align =</span> <span class="st">"h"</span>, <span class="at">axis =</span> <span class="st">"tb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in as_grob.default(plot): Cannot convert object of class
ggmatrixGGally::ggmatrixS7_object into a grob.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>However, it works like this:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="fu">ggmatrix_gtable</span>(gp), g1, <span class="at">align =</span> <span class="st">"h"</span>, <span class="at">axis =</span> <span class="st">"tb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 49 rows containing missing values
Removed 49 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 49 rows containing missing values or values outside the scale range
(`geom_point()`).
Removed 49 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 49 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="patchwork" class="level2">
<h2 class="anchored" data-anchor-id="patchwork">patchwork</h2>
<p>Another package that lets us combine <code>ggplot</code> objects is <code>patchwork</code>. The syntax here is a bit different - <code>|</code> combines plots horizontally, and <code>/</code> combines plots vertically.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">|</span> g2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">/</span> g2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>(g1 <span class="sc">/</span> g2) <span class="sc">|</span> g3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-66-3.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>We can add additional annotations (e.g., a shared title) as well:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>pw <span class="ot">&lt;-</span> (g1 <span class="sc">/</span> g2) <span class="sc">|</span> g3</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>pw <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Here is the title"</span>,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"And a subtitle"</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"And a caption"</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intermediate_ggplot2_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="other-material-sources-for-some-of-the-material-presented-above" class="level1">
<h1>Other material, sources for some of the material presented above</h1>
<ul>
<li><a href="https://uc-r.github.io/ggplot">https://uc-r.github.io/ggplot</a></li>
<li><a href="https://exts.ggplot2.tidyverse.org/gallery/">https://exts.ggplot2.tidyverse.org/gallery/</a></li>
<li><a href="https://www.youtube.com/watch?v=8ikFe82Mb1I&amp;ab_channel=R-LadiesTunis">https://www.youtube.com/watch?v=8ikFe82Mb1I&amp;ab_channel=R-LadiesTunis</a></li>
<li><a href="https://stulp.gmw.rug.nl/ggplotworkshop/advancedggplot.html#showing-all-data-in-facets">https://stulp.gmw.rug.nl/ggplotworkshop/advancedggplot.html#showing-all-data-in-facets</a></li>
<li><a href="https://stackoverflow.com/questions/61922380/preserve-location-of-missing-columns-in-combined-bar-plot">https://stackoverflow.com/questions/61922380/preserve-location-of-missing-columns-in-combined-bar-plot</a></li>
<li><a href="https://lpembleton.rbind.io/ramblings/r/">https://lpembleton.rbind.io/ramblings/r/</a></li>
<li><a href="https://z3tt.github.io/exciting-extensions/slides.html#/title-slide">Exciting data visualizations with ggplot2 extensions</a></li>
<li><a href="https://github.com/erikgahner/awesome-ggplot2/">Awesome ggplot2</a></li>
</ul>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.5.2 (2025-10-31)
 os       Ubuntu 24.04.3 LTS
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  C.UTF-8
 ctype    C.UTF-8
 tz       UTC
 date     2025-11-24
 pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown)
 quarto   1.8.26 @ /usr/local/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 package          * version   date (UTC) lib source
 ash                1.0-15    2015-09-01 [1] CRAN (R 4.5.2)
 bayestestR         0.17.0    2025-08-29 [1] CRAN (R 4.5.2)
 circlize         * 0.4.16    2024-02-20 [1] CRAN (R 4.5.2)
 cli                3.6.5     2025-04-23 [1] CRAN (R 4.5.2)
 codetools          0.2-20    2024-03-31 [2] CRAN (R 4.5.2)
 colorspace       * 2.1-2     2025-09-22 [1] CRAN (R 4.5.2)
 correlation        0.8.8     2025-07-08 [1] CRAN (R 4.5.2)
 cowplot          * 1.2.0     2025-07-07 [1] CRAN (R 4.5.2)
 crosstalk          1.2.2     2025-08-26 [1] CRAN (R 4.5.2)
 data.table         1.17.8    2025-07-10 [1] CRAN (R 4.5.2)
 datawizard         1.3.0     2025-10-11 [1] CRAN (R 4.5.2)
 digest             0.6.39    2025-11-19 [1] CRAN (R 4.5.2)
 directlabels     * 2025.6.24 2025-06-24 [1] CRAN (R 4.5.2)
 dplyr            * 1.1.4     2023-11-17 [1] CRAN (R 4.5.2)
 effectsize         1.0.1     2025-05-27 [1] CRAN (R 4.5.2)
 evaluate           1.0.5     2025-08-27 [1] CRAN (R 4.5.2)
 extrafont          0.20      2025-09-24 [1] CRAN (R 4.5.2)
 extrafontdb        1.1       2025-09-28 [1] CRAN (R 4.5.2)
 farver             2.1.2     2024-05-13 [1] CRAN (R 4.5.2)
 fastmap            1.2.0     2024-05-15 [1] CRAN (R 4.5.2)
 forcats          * 1.0.1     2025-09-25 [1] CRAN (R 4.5.2)
 fueleconomy      * 1.0.0     2020-03-23 [1] CRAN (R 4.5.2)
 generics           0.1.4     2025-05-09 [1] CRAN (R 4.5.2)
 GGally           * 2.4.0     2025-08-23 [1] CRAN (R 4.5.2)
 ggalt            * 0.6.1     2025-11-24 [1] Github (hrbrmstr/ggalt@8941f8c)
 gghighlight      * 0.5.0     2025-06-14 [1] CRAN (R 4.5.2)
 ggnewscale       * 0.5.2     2025-06-20 [1] CRAN (R 4.5.2)
 ggplot2          * 4.0.1     2025-11-14 [1] CRAN (R 4.5.2)
 ggrepel          * 0.9.6     2024-09-07 [1] CRAN (R 4.5.2)
 ggridges         * 0.5.7     2025-08-27 [1] CRAN (R 4.5.2)
 ggsignif         * 0.6.4     2022-10-13 [1] CRAN (R 4.5.2)
 ggstats            0.11.0    2025-09-15 [1] CRAN (R 4.5.2)
 ggstatsplot      * 0.13.3    2025-10-05 [1] CRAN (R 4.5.2)
 ggtext           * 0.1.2     2022-09-16 [1] CRAN (R 4.5.2)
 GlobalOptions      0.1.2     2020-06-10 [1] CRAN (R 4.5.2)
 glue               1.8.0     2024-09-30 [1] CRAN (R 4.5.2)
 gridtext           0.1.5     2022-09-16 [1] CRAN (R 4.5.2)
 gtable             0.3.6     2024-10-25 [1] CRAN (R 4.5.2)
 htmltools          0.5.8.1   2024-04-04 [1] CRAN (R 4.5.2)
 htmlwidgets        1.6.4     2023-12-06 [1] CRAN (R 4.5.2)
 httr               1.4.7     2023-08-15 [1] CRAN (R 4.5.2)
 insight            1.4.2     2025-09-02 [1] CRAN (R 4.5.2)
 jsonlite           2.0.0     2025-03-27 [1] CRAN (R 4.5.2)
 KernSmooth         2.23-26   2025-01-01 [2] CRAN (R 4.5.2)
 knitr              1.50      2025-03-16 [1] CRAN (R 4.5.2)
 labeling           0.4.3     2023-08-29 [1] CRAN (R 4.5.2)
 lattice            0.22-7    2025-04-02 [2] CRAN (R 4.5.2)
 lazyeval           0.2.2     2019-03-15 [1] CRAN (R 4.5.2)
 lifecycle          1.0.4     2023-11-07 [1] CRAN (R 4.5.2)
 magrittr           2.0.4     2025-09-12 [1] CRAN (R 4.5.2)
 maps               3.4.3     2025-05-26 [1] CRAN (R 4.5.2)
 MASS               7.3-65    2025-02-28 [2] CRAN (R 4.5.2)
 Matrix             1.7-4     2025-08-28 [2] CRAN (R 4.5.2)
 mgcv               1.9-3     2025-04-04 [2] CRAN (R 4.5.2)
 nlme               3.1-168   2025-03-31 [2] CRAN (R 4.5.2)
 paletteer          1.6.0     2024-01-21 [1] CRAN (R 4.5.2)
 parameters         0.28.2    2025-09-10 [1] CRAN (R 4.5.2)
 patchwork        * 1.3.2     2025-08-25 [1] CRAN (R 4.5.2)
 pillar             1.11.1    2025-09-17 [1] CRAN (R 4.5.2)
 pkgconfig          2.0.3     2019-09-22 [1] CRAN (R 4.5.2)
 plotly           * 4.11.0    2025-06-19 [1] CRAN (R 4.5.2)
 proj4              1.0-15    2025-03-21 [1] CRAN (R 4.5.2)
 purrr              1.2.0     2025-11-04 [1] CRAN (R 4.5.2)
 quadprog           1.5-8     2019-11-20 [1] CRAN (R 4.5.2)
 R6                 2.6.1     2025-02-15 [1] CRAN (R 4.5.2)
 RColorBrewer     * 1.1-3     2022-04-03 [1] CRAN (R 4.5.2)
 Rcpp               1.1.0     2025-07-02 [1] CRAN (R 4.5.2)
 RcppParallel       5.1.11-1  2025-08-27 [1] CRAN (R 4.5.2)
 rematch2           2.1.2     2020-05-01 [1] CRAN (R 4.5.2)
 rlang              1.1.6     2025-04-11 [1] CRAN (R 4.5.2)
 rmarkdown          2.30      2025-09-28 [1] CRAN (R 4.5.2)
 rstantools         2.5.0     2025-09-01 [1] CRAN (R 4.5.2)
 Rttf2pt1           1.3.14    2025-09-26 [1] CRAN (R 4.5.2)
 S7                 0.2.1     2025-11-14 [1] CRAN (R 4.5.2)
 scales           * 1.4.0     2025-04-24 [1] CRAN (R 4.5.2)
 scattermore      * 1.2       2023-06-12 [1] CRAN (R 4.5.2)
 sessioninfo      * 1.2.3     2025-02-05 [1] CRAN (R 4.5.2)
 shape              1.4.6.1   2024-02-23 [1] CRAN (R 4.5.2)
 statsExpressions   1.7.1     2025-07-27 [1] CRAN (R 4.5.2)
 tibble             3.3.0     2025-06-08 [1] CRAN (R 4.5.2)
 tidyr            * 1.3.1     2024-01-24 [1] CRAN (R 4.5.2)
 tidyselect         1.2.1     2024-03-11 [1] CRAN (R 4.5.2)
 utf8               1.2.6     2025-06-08 [1] CRAN (R 4.5.2)
 vctrs              0.6.5     2023-12-01 [1] CRAN (R 4.5.2)
 viridisLite        0.4.2     2023-05-02 [1] CRAN (R 4.5.2)
 withr              3.0.2     2024-10-28 [1] CRAN (R 4.5.2)
 xfun               0.54      2025-10-30 [1] CRAN (R 4.5.2)
 xml2               1.5.0     2025-11-17 [1] CRAN (R 4.5.2)
 yaml               2.3.10    2024-07-26 [1] CRAN (R 4.5.2)
 zeallot            0.2.0     2025-05-27 [1] CRAN (R 4.5.2)

 [1] /home/runner/work/_temp/Library
 [2] /opt/R/4.5.2/lib/R/library
 * ── Packages attached to the search path.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>